<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="Náº¿u UnionFS lÃ  Ã½ tÆ°á»Ÿng, thÃ¬ OverlayFS lÃ  báº£n thá»±c thi xuáº¥t sáº¯c nháº¥t hiá»‡n nay trÃªn Linux. NÃ³ kháº¯c phá»¥c Ä‘Æ°á»£c sá»± cá»“ng ká»nh vÃ  cháº­m cháº¡p cá»§a cÃ¡c tháº¿ há»‡ trÆ°á»›c (nhÆ° AUFS hay Device Mapper)\n"><title>OverlayFS - overlay2 on Docker</title><link rel=canonical href=https://blog.nagih.io.vn/posts/storage/overlayfs/><link rel=stylesheet href=/scss/style.min.833d6eed45de56f48306bf57268d5b8cdfc8a60e8e7bdc99810464fcd033f7c6.css><meta property='og:title' content="OverlayFS - overlay2 on Docker"><meta property='og:description' content="Náº¿u UnionFS lÃ  Ã½ tÆ°á»Ÿng, thÃ¬ OverlayFS lÃ  báº£n thá»±c thi xuáº¥t sáº¯c nháº¥t hiá»‡n nay trÃªn Linux. NÃ³ kháº¯c phá»¥c Ä‘Æ°á»£c sá»± cá»“ng ká»nh vÃ  cháº­m cháº¡p cá»§a cÃ¡c tháº¿ há»‡ trÆ°á»›c (nhÆ° AUFS hay Device Mapper)\n"><meta property='og:url' content='https://blog.nagih.io.vn/posts/storage/overlayfs/'><meta property='og:site_name' content='Nagih | Blog'><meta property='og:type' content='article'><meta property='article:section' content='Posts'><meta property='article:tag' content='overlayfs'><meta property='article:published_time' content='2025-12-28T00:00:00+00:00'><meta property='article:modified_time' content='2025-12-28T00:00:00+00:00'><meta name=twitter:title content="OverlayFS - overlay2 on Docker"><meta name=twitter:description content="Náº¿u UnionFS lÃ  Ã½ tÆ°á»Ÿng, thÃ¬ OverlayFS lÃ  báº£n thá»±c thi xuáº¥t sáº¯c nháº¥t hiá»‡n nay trÃªn Linux. NÃ³ kháº¯c phá»¥c Ä‘Æ°á»£c sá»± cá»“ng ká»nh vÃ  cháº­m cháº¡p cá»§a cÃ¡c tháº¿ há»‡ trÆ°á»›c (nhÆ° AUFS hay Device Mapper)\n"></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/images/VuongManhNghia_hu_d72cb41bfd209668.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>ğŸ¥</span></figure><div class=site-meta><h1 class=site-name><a href=/>Nagih | Blog</a></h1><h2 class=site-description>Hi there, I'm Vuong Manh Nghia.</h2></div></header><ol class=menu-social><li><a href=https://discord.gg/nagih_isme target=_blank title=Discord rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M8 12a1 1 0 102 0 1 1 0 00-2 0"/><path d="M14 12a1 1 0 102 0 1 1 0 00-2 0"/><path d="M15.5 17c0 1 1.5 3 2 3 1.5.0 2.833-1.667 3.5-3 .667-1.667.5-5.833-1.5-11.5-1.457-1.015-3-1.34-4.5-1.5l-.972 1.923a11.913 11.913.0 00-4.053.0L9 4c-1.5.16-3.043.485-4.5 1.5-2 5.667-2.167 9.833-1.5 11.5.667 1.333 2 3 3.5 3 .5.0 2-2 2-3"/><path d="M7 16.5c3.5 1 6.5 1 10 0"/></svg></a></li><li><a href=https://www.facebook.com/vmn.isme target=_blank title=Facebook rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M7 10v4h3v7h4v-7h3l1-4h-4V8a1 1 0 011-1h3V3h-3a5 5 0 00-5 5v2H7"/></svg></a></li><li><a href=https://github.com/vuongmanhnghia target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://www.linkedin.com/in/vuongmanhnghia target=_blank title=LinkedIn rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4m0 2a2 2 0 012-2h12a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2z"/><path d="M8 11v5"/><path d="M8 8v.01"/><path d="M12 16v-5"/><path d="M16 16v-3a2 2 0 00-4 0"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/categories/><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg>
<span>Categories</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><ol><li><a href=#1-kiáº¿n-trÃºc-4-thÃ nh-pháº§n-cá»§a-overlayfs>1. Kiáº¿n trÃºc 4 thÃ nh pháº§n cá»§a OverlayFS</a></li><li><a href=#2-cÆ¡-cháº¿-hoáº¡t-Ä‘á»™ng-chi-tiáº¿t-deep-dive>2. CÆ¡ cháº¿ hoáº¡t Ä‘á»™ng chi tiáº¿t (Deep Dive)</a></li><li><a href=#3-táº¡i-sao-overlay2-láº¡i-tá»‘t-hÆ¡n-cÃ¡c-unionfs-cÅ©-nhÆ°-aufs>3. Táº¡i sao Overlay2 láº¡i tá»‘t hÆ¡n cÃ¡c UnionFS cÅ© (nhÆ° AUFS)?</a></li><li><a href=#bÃ i-viáº¿t-liÃªn-quan>BÃ i viáº¿t liÃªn quan</a></li></ol></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/storage/>Storage</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/posts/storage/overlayfs/>OverlayFS - overlay2 on Docker</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published datetime=2025-12-28T00:00:00Z>December 28, 2025</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>5 minute read</time></div></footer></div></header><section class=article-content><p>Náº¿u UnionFS lÃ  Ã½ tÆ°á»Ÿng, thÃ¬ OverlayFS lÃ  báº£n thá»±c thi xuáº¥t sáº¯c nháº¥t hiá»‡n nay trÃªn Linux. NÃ³ kháº¯c phá»¥c Ä‘Æ°á»£c sá»± cá»“ng ká»nh vÃ  cháº­m cháº¡p cá»§a cÃ¡c tháº¿ há»‡ trÆ°á»›c (nhÆ° AUFS hay Device Mapper)</p><hr><p>Tiáº¿p ná»‘i cÃ¢u chuyá»‡n vá» UnionFS, chÃºng ta sáº½ Ä‘i sÃ¢u vÃ o <strong>OverlayFS</strong> (cá»¥ thá»ƒ lÃ  driver <code>overlay2</code> trong Docker).</p><h3 id=1-kiáº¿n-trÃºc-4-thÃ nh-pháº§n-cá»§a-overlayfs>1. Kiáº¿n trÃºc 4 thÃ nh pháº§n cá»§a OverlayFS</h3><p>KhÃ¡c vá»›i cÃ¡ch nÃ³i chung chung &ldquo;xáº¿p lá»›p&rdquo;, OverlayFS Ä‘á»‹nh nghÄ©a cáº¥u trÃºc ráº¥t rÃµ rÃ ng vá»›i 4 thÆ° má»¥c chÃ­nh khi mount:</p><ol><li><p><strong>LowerDir (Táº§ng dÆ°á»›i - Read-only):</strong></p><ul><li><p>ÄÃ¢y chÃ­nh lÃ  cÃ¡c <strong>Docker Image layers</strong>.</p></li><li><p>NÃ³ cÃ³ thá»ƒ bao gá»“m nhiá»u lá»›p xáº¿p chá»“ng lÃªn nhau.</p></li><li><p>Äáº·c Ä‘iá»ƒm: Chá»‰ Ä‘Æ°á»£c Ä‘á»c, tuyá»‡t Ä‘á»‘i khÃ´ng Ä‘Æ°á»£c sá»­a.</p></li></ul></li><li><p><strong>UpperDir (Táº§ng trÃªn - Read-Write):</strong></p><ul><li><p>ÄÃ¢y lÃ  <strong>Container layer</strong>.</p></li><li><p>NÆ¡i chá»©a táº¥t cáº£ nhá»¯ng thay Ä‘á»•i báº¡n thá»±c hiá»‡n khi container Ä‘ang cháº¡y (file má»›i táº¡o, file bá»‹ sá»­a).</p></li></ul></li><li><p><strong>Merged (Táº§ng há»£p nháº¥t - View):</strong></p><ul><li><p>ÄÃ¢y lÃ  Ä‘iá»ƒm mount mÃ  ngÆ°á»i dÃ¹ng nhÃ¬n tháº¥y (vÃ­ dá»¥ <code>/var/lib/docker/overlay2/.../merged</code>).</p></li><li><p>NÃ³ áº£o hÃ³a viá»‡c gá»™p <code>LowerDir</code> vÃ  <code>UpperDir</code>.</p></li></ul></li><li><p><strong>WorkDir (Táº§ng Ä‘á»‡m):</strong></p><ul><li>ÄÃ¢y lÃ  thÆ° má»¥c ná»™i bá»™ Ä‘á»ƒ OverlayFS xá»­ lÃ½ cÃ¡c tÃ¡c vá»¥ trung gian (nhÆ° chuáº©n bá»‹ file trÆ°á»›c khi di chuyá»ƒn sang UpperDir) Ä‘á»ƒ Ä‘áº£m báº£o tÃ­nh toÃ n váº¹n dá»¯ liá»‡u (atomicity).</li></ul></li></ol><h3 id=2-cÆ¡-cháº¿-hoáº¡t-Ä‘á»™ng-chi-tiáº¿t-deep-dive>2. CÆ¡ cháº¿ hoáº¡t Ä‘á»™ng chi tiáº¿t (Deep Dive)</h3><p>OverlayFS hoáº¡t Ä‘á»™ng á»Ÿ cáº¥p Ä‘á»™ <strong>File (Tá»‡p tin)</strong>, khÃ´ng pháº£i cáº¥p Ä‘á»™ Block (Khá»‘i Ä‘Ä©a). Äiá»u nÃ y ráº¥t quan trá»ng Ä‘á»ƒ hiá»ƒu hiá»‡u nÄƒng.</p><p><strong>A. Äá»c file (Reading)</strong></p><ul><li><p>Náº¿u file náº±m á»Ÿ <code>UpperDir</code>: Há»‡ thá»‘ng Ä‘á»c ngay láº­p tá»©c (Ráº¥t nhanh).</p></li><li><p>Náº¿u file khÃ´ng cÃ³ á»Ÿ <code>Upper</code> mÃ  chá»‰ cÃ³ á»Ÿ <code>Lower</code>: Há»‡ thá»‘ng Ä‘á»c tá»« <code>Lower</code>.</p></li><li><p><strong>Hiá»‡u nÄƒng:</strong> Gáº§n nhÆ° tá»‘c Ä‘á»™ á»• cá»©ng gá»‘c (Native speed).</p></li></ul><p><strong>B. Ghi file (Writing & Copy_up) - Äiá»ƒm máº¥u chá»‘t</strong></p><p>ÄÃ¢y lÃ  lÃºc cÆ¡ cháº¿ <strong>Copy-on-Write (CoW)</strong> cá»§a OverlayFS hoáº¡t Ä‘á»™ng, thuáº­t ngá»¯ chuyÃªn ngÃ nh gá»i lÃ  <strong><code>copy_up</code></strong>:</p><ol><li><p>Báº¡n má»Ÿ má»™t file 100MB cÃ³ sáºµn trong Image (Lower) Ä‘á»ƒ sá»­a.</p></li><li><p>OverlayFS nháº­n lá»‡nh ghi. NÃ³ táº¡m dá»«ng láº¡i.</p></li><li><p>NÃ³ tÃ¬m file Ä‘Ã³ á»Ÿ <code>LowerDir</code>.</p></li><li><p>NÃ³ <strong>COPY toÃ n bá»™ file 100MB</strong> Ä‘Ã³ lÃªn <code>UpperDir</code>.</p></li><li><p>Sau khi copy xong, nÃ³ má»›i cho phÃ©p á»©ng dá»¥ng ghi dá»¯ liá»‡u vÃ o báº£n sao á»Ÿ <code>UpperDir</code>.</p></li></ol><blockquote><p><strong>LÆ°u Ã½ quan trá»ng:</strong> OverlayFS hoáº¡t Ä‘á»™ng theo file. DÃ¹ báº¡n chá»‰ sá»­a 1 kÃ½ tá»± trong file 1GB, nÃ³ cÅ©ng pháº£i copy cáº£ file 1GB Ä‘Ã³ lÃªn trÃªn. ÄÃ¢y lÃ  lÃ½ do nÃ³ cháº­m hÆ¡n Volume khi ghi láº§n Ä‘áº§u.</p></blockquote><p><strong>C. XÃ³a file (Deleting & Whiteout)</strong></p><p>LÃ m sao xÃ³a file á»Ÿ <code>LowerDir</code> (vá»‘n Read-only)?</p><ul><li><p>OverlayFS táº¡o ra má»™t file Ä‘áº·c biá»‡t trong <code>UpperDir</code> gá»i lÃ  <strong>Whiteout file</strong> (thÆ°á»ng lÃ  má»™t character device vá»›i major/minor number lÃ  0/0).</p></li><li><p>File nÃ y trÃ¹ng tÃªn vá»›i file cáº§n xÃ³a.</p></li><li><p>Khi báº¡n nhÃ¬n vÃ o thÆ° má»¥c <code>Merged</code>, OverlayFS tháº¥y file Whiteout nÃ y vÃ  sáº½ &ldquo;áº©n&rdquo; file gá»‘c á»Ÿ dÆ°á»›i Ä‘i.</p></li></ul><h3 id=3-táº¡i-sao-overlay2-láº¡i-tá»‘t-hÆ¡n-cÃ¡c-unionfs-cÅ©-nhÆ°-aufs>3. Táº¡i sao Overlay2 láº¡i tá»‘t hÆ¡n cÃ¡c UnionFS cÅ© (nhÆ° AUFS)?</h3><p>TrÆ°á»›c Ä‘Ã¢y Docker dÃ¹ng AUFS, nhÆ°ng giá» chuyá»ƒn sang Overlay2 vÃ¬ 2 lÃ½ do cá»±c lá»›n:</p><p><strong>1. Page Cache Sharing (Chia sáº» bá»™ nhá»› Ä‘á»‡m) - Cá»±c ká»³ quan trá»ng</strong></p><p>HÃ£y tÆ°á»Ÿng tÆ°á»£ng báº¡n cháº¡y <strong>10 Container</strong> tá»« cÃ¹ng má»™t Image <code>node:latest</code>.</p><ul><li><p>Image nÃ y cÃ³ file <code>/usr/bin/node</code> (náº·ng 50MB).</p></li><li><p><strong>Vá»›i cÃ¡c cÃ´ng nghá»‡ cÅ© (Device Mapper):</strong> NÃ³ cÃ³ thá»ƒ táº£i 10 báº£n copy vÃ o RAM -> Tá»‘n 500MB RAM.</p></li><li><p><strong>Vá»›i OverlayFS:</strong> VÃ¬ cÃ¡c lá»›p <code>LowerDir</code> lÃ  giá»‘ng há»‡t nhau vá» máº·t váº­t lÃ½, Linux Kernel thÃ´ng minh nháº­n ra chÃºng cÃ¹ng chung má»™t <strong>Inode</strong> trÃªn á»• cá»©ng.</p><ul><li><p>Kernel chá»‰ táº£i file <code>/usr/bin/node</code> vÃ o RAM <strong>má»™t láº§n duy nháº¥t</strong> (Page Cache).</p></li><li><p>Cáº£ 10 container Ä‘á»u dÃ¹ng chung vÃ¹ng nhá»› Ä‘á»‡m Ä‘Ã³.</p></li><li><p><strong>Káº¿t quáº£:</strong> Tiáº¿t kiá»‡m RAM khá»§ng khiáº¿p khi cháº¡y nhiá»u container giá»‘ng nhau (vÃ­ dá»¥ trong Kubernetes).</p></li></ul></li></ul><p><strong>2. Tá»‘c Ä‘á»™ vÃ  Sá»± Ä‘Æ¡n giáº£n</strong></p><ul><li><p>OverlayFS Ä‘Æ°á»£c tÃ­ch há»£p trá»±c tiáº¿p vÃ o <strong>Linux Kernel Mainline</strong>. NÃ³ khÃ´ng cáº§n cÃ i thÃªm module ngoÃ i. Code cá»§a nÃ³ gá»n nháº¹ hÆ¡n nhiá»u so vá»›i AUFS.</p></li><li><p>Tá»‘c Ä‘á»™ táº¡o container (mount overlay) nhanh hÆ¡n ráº¥t nhiá»u so vá»›i viá»‡c táº¡o snapshot cá»§a Device Mapper.</p></li></ul><p><strong>4. Giá»›i háº¡n cá»§a OverlayFS</strong></p><p>DÃ¹ ráº¥t tá»‘t, OverlayFS váº«n cÃ³ Ä‘iá»ƒm yáº¿u mÃ  báº¡n cáº§n biáº¿t khi váº­n hÃ nh há»‡ thá»‘ng:</p><ol><li><p><strong>Rename Directory (Äá»•i tÃªn thÆ° má»¥c):</strong> OverlayFS (chuáº©n POSIX) khÃ´ng há»— trá»£ hoÃ n háº£o viá»‡c Ä‘á»•i tÃªn thÆ° má»¥c náº¿u thÆ° má»¥c Ä‘Ã³ náº±m á»Ÿ lá»›p <code>Lower</code> vÃ  báº¡n muá»‘n Ä‘á»•i tÃªn nÃ³ á»Ÿ lá»›p <code>Upper</code>. Docker pháº£i dÃ¹ng máº¹o (copy thÆ° má»¥c cÅ© sang tÃªn má»›i rá»“i xÃ³a cÅ©) -> Ráº¥t tá»‘n kÃ©m náº¿u thÆ° má»¥c lá»›n.</p></li><li><p><strong>KhÃ´ng phÃ¹ há»£p ghi dá»¯ liá»‡u lá»›n:</strong> NhÆ° Ä‘Ã£ nÃ³i, vÃ¬ cÆ¡ cháº¿ copy toÃ n bá»™ file (<code>copy_up</code>), nÃªn tuyá»‡t Ä‘á»‘i khÃ´ng Ä‘á»ƒ Database file trÃªn OverlayFS.</p></li><li><p><strong>Inode exhaustion (Cáº¡n kiá»‡t Inode):</strong> ÄÃ¢y lÃ  váº¥n Ä‘á» cá»§a driver <code>overlay</code> cÅ©. Driver <code>overlay2</code> Ä‘Ã£ kháº¯c phá»¥c Ä‘Æ°á»£c Ä‘iá»u nÃ y, nhÆ°ng náº¿u báº¡n táº¡o quÃ¡ nhiá»u file nhá» trong container, báº¡n váº«n cÃ³ thá»ƒ lÃ m háº¿t Inode cá»§a á»• cá»©ng host.</p></li></ol><p><strong>TÃ³m láº¡i:</strong> OverlayFS lÃ  sá»± káº¿t há»£p hoÃ n háº£o giá»¯a tá»‘c Ä‘á»™ Ä‘á»c (nhá» Page Cache sharing) vÃ  kháº£ nÄƒng quáº£n lÃ½ layer linh hoáº¡t. Tuy nhiÃªn, báº£n cháº¥t &ldquo;Copy nguyÃªn file&rdquo; khi ghi Ä‘Ã¨ khiáº¿n nÃ³ luÃ´n thua Volume á»Ÿ cÃ¡c tÃ¡c vá»¥ ghi náº·ng (Write-heavy workloads).</p><hr><h3 id=bÃ i-viáº¿t-liÃªn-quan>BÃ i viáº¿t liÃªn quan</h3><ul><li><p><a href=/posts/storage/unionfs/>UnionFS</a></p></li><li><p><a href=/overlay2-vs-volume-&-bind-mount/>Táº¡i sao overlay2 trÃªn Docker láº¡i cÃ³ hiá»‡u nÄƒng kÃ©m hÆ¡n Volume/Bind Mount ?</a></p></li></ul><hr></section><footer class=article-footer><section class=article-tags><a href=/tags/overlayfs/>Overlayfs</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/posts/storage/overlay2-vs-volume--bind-mount/><div class=article-details><h2 class=article-title>Táº¡i sao overlay2 trÃªn Docker láº¡i cÃ³ hiá»‡u nÄƒng kÃ©m hÆ¡n Volume vÃ  Bind Mount ?</h2></div></a></article><article><a href=/posts/storage/unionfs/><div class=article-details><h2 class=article-title>UnionFS - Union File System</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2025 -
2026 Vuong Manh Nghia</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.33.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.c922af694cc257bf1ecc41c0dd7b0430f9114ec280ccf67cd2c6ad55f5316c4e.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>