<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>Networking on Nagih | Blog</title>
        <link>https://blog.nagih.io.vn/posts/networking/</link>
        <description>Recent content in Networking on Nagih | Blog</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>en</language>
        <copyright>Vuong Manh Nghia</copyright>
        <lastBuildDate>Sun, 30 Nov 2025 00:00:00 +0000</lastBuildDate><atom:link href="https://blog.nagih.io.vn/posts/networking/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>Netstat - Công cụ giám sát Networking</title>
        <link>https://blog.nagih.io.vn/posts/networking/netstat/</link>
        <pubDate>Sun, 30 Nov 2025 00:00:00 +0000</pubDate>
        
        <guid>https://blog.nagih.io.vn/posts/networking/netstat/</guid>
        <description>&lt;p&gt;&lt;strong&gt;Netstat&lt;/strong&gt; là công cụ dòng lệnh dùng để hiển thị chi tiết các kết nối mạng (TCP/UDP), bảng định tuyến và các cổng đang lắng nghe, giúp quản trị viên giám sát và xử lý sự cố hệ thống.&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;1-tư-duy-cốt-lõi-tại-sao-cần-netstat&#34;&gt;1. Tư duy cốt lõi: Tại sao cần Netstat?
&lt;/h3&gt;&lt;p&gt;Khi một ứng dụng bị lỗi kết nối, DevOps Engineer sẽ đặt ra các câu hỏi sau và &lt;code&gt;netstat&lt;/code&gt; là công cụ trả lời:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Availability:&lt;/strong&gt; Port của service có đang mở (Listening) không?&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Binding:&lt;/strong&gt; Service đang lắng nghe trên IP nào? (Localhost &lt;code&gt;127.0.0.1&lt;/code&gt; hay Public &lt;code&gt;0.0.0.0&lt;/code&gt;)?&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Process Mapping:&lt;/strong&gt; Process nào (PID) đang chiếm dụng port đó?&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Performance:&lt;/strong&gt; Có bao nhiêu kết nối đang ở trạng thái chờ (TIME_WAIT, CLOSE_WAIT)?&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Security:&lt;/strong&gt; Có IP lạ nào đang kết nối vào server không?&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;2-vũ-khí-thường-dùng-các-flag-quan-trọng&#34;&gt;2. &amp;ldquo;Vũ khí&amp;rdquo; thường dùng: Các Flag quan trọng
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;Combo: &lt;code&gt;netstat -tulpn&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Đây là lệnh đầu tiên tôi gõ khi debug network.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;-t&lt;/code&gt; (TCP): Chỉ hiện các kết nối TCP.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;-u&lt;/code&gt; (UDP): Chỉ hiện các kết nối UDP.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;-l&lt;/code&gt; (Listening): Chỉ hiện các socket đang lắng nghe (Server mode).&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;-p&lt;/code&gt; (Process): Hiển thị PID và tên chương trình (Cần quyền &lt;code&gt;sudo&lt;/code&gt;).&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;-n&lt;/code&gt; (Numeric): &lt;strong&gt;Rất quan trọng&lt;/strong&gt;. Hiển thị IP và Port bằng số thay vì phân giải tên miền (DNS resolution). Nếu không có &lt;code&gt;-n&lt;/code&gt;, lệnh sẽ chạy rất chậm khi DNS server gặp vấn đề.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Ví dụ output:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;tcp        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 0.0.0.0:80              0.0.0.0:*               LISTEN      1234/nginx
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;tcp        &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; 127.0.0.1:3306          0.0.0.0:*               LISTEN      5678/mysqld
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Phân tích:&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Nginx&lt;/strong&gt; đang mở port 80 cho tất cả IP (&lt;code&gt;0.0.0.0&lt;/code&gt;)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;MySQL&lt;/strong&gt; chỉ cho phép kết nối từ nội bộ (&lt;code&gt;127.0.0.1&lt;/code&gt;). Đây là một check-point về bảo mật.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;3-phân-tích-sâu-về-tcp-states-quan-trọng-cho-performance&#34;&gt;3. Phân tích sâu về TCP States (Quan trọng cho Performance)
&lt;/h3&gt;&lt;p&gt;Cần đặc biệt chú ý đến cột &lt;strong&gt;State&lt;/strong&gt;. Nó phản ánh sức khỏe của ứng dụng.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;a. &lt;code&gt;ESTABLISHED&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Kết nối đang hoạt động bình thường.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Use case:&lt;/strong&gt; Đếm số lượng user đang online (concurrent connections).&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;netstat -anp &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; grep :80 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; grep ESTABLISHED &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; wc -l
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;-a&lt;/code&gt; (All):&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Tất cả các socket, bao gồm cả các socket đang lắng nghe (Listening) và các socket đã thiết lập kết nối.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Nếu không có cờ này, mặc định netstat thường chỉ hiện các kết nối đã thiết lập.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;-n&lt;/code&gt; (Numeric): Đã giải thích ở trên&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;-p&lt;/code&gt; (Program):&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Hiển thị &lt;strong&gt;PID&lt;/strong&gt; (Process ID) và &lt;strong&gt;tên chương trình&lt;/strong&gt; đang sở hữu kết nối đó (ví dụ: 1234/nginx)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Cần &lt;code&gt;root&lt;/code&gt; hoặc &lt;code&gt;sudo&lt;/code&gt; để thấy PID của các process không thuộc user hiện tại&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;wc -l&lt;/code&gt;:  Công cụ đếm&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;-l&lt;/code&gt; (Lines Flag này bảo wc chỉ đếm &lt;strong&gt;số dòng&lt;/strong&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;-&amp;gt; Kết quả cuối cùng trả về một con số duy nhất (Ví dụ: 50 nghĩa là có 50 người đang kết nối vào web server).&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;b. &lt;code&gt;TIME_WAIT&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Kết nối đã đóng, nhưng kernel giữ lại socket một lúc để đảm bảo các gói tin lạc đường được xử lý xong.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Vấn đề:&lt;/strong&gt; Nếu server có quá nhiều &lt;code&gt;TIME_WAIT&lt;/code&gt; (hàng nghìn), server có thể bị cạn kiệt &lt;strong&gt;Ephemeral Ports&lt;/strong&gt; (hết port để mở kết nối mới).&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Giải pháp:&lt;/strong&gt; Tinh chỉnh sysctl (&lt;code&gt;net.ipv4.tcp_tw_reuse&lt;/code&gt;, &lt;code&gt;net.ipv4.tcp_fin_timeout&lt;/code&gt;).&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;c. &lt;code&gt;CLOSE_WAIT&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Đây là trạng thái nguy hiểm nhất.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Ý nghĩa:&lt;/strong&gt; Phía bên kia đã đóng kết nối, nhưng ứng dụng trên server của bạn &lt;strong&gt;chưa&lt;/strong&gt; đóng socket.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Nguyên nhân:&lt;/strong&gt; Thường là do &lt;strong&gt;bug trong code&lt;/strong&gt; (quên &lt;code&gt;socket.close()&lt;/code&gt;) hoặc ứng dụng bị treo/deadlock.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Hành động:&lt;/strong&gt; Báo ngay cho team Dev hoặc restart service để giải phóng tài nguyên.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;d. &lt;code&gt;SYN_SENT&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Server gửi yêu cầu kết nối nhưng không nhận được phản hồi.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Nguyên nhân:&lt;/strong&gt; Thường do Firewall chặn hoặc IP đích không tồn tại.&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;4-netstat-trong-security--audit-bảo-mật&#34;&gt;4. Netstat trong Security &amp;amp; Audit (Bảo mật)
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;a. Phát hiện DDoS hoặc Traffic bất thường&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Bạn muốn biết IP nào đang kết nối nhiều nhất vào server?&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;netstat -ntu &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; awk &lt;span class=&#34;s1&#34;&gt;&amp;#39;{print $5}&amp;#39;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; cut -d: -f1 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; sort &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; uniq -c &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; sort -nr &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; head -10
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;Lệnh này sẽ liệt kê Top 10 IP đang kết nối.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;b. Kiểm tra Backdoor/Malware&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Nếu thấy một port lạ mở (ví dụ: 4444, 6666) và process name lạ hoặc không có tên:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;netstat -tulpn
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Kiểm tra PID đó là gì: &lt;code&gt;ps -ef | grep &amp;lt;PID&amp;gt;&lt;/code&gt;.&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;5-routing-và-interface-statistics&#34;&gt;5. Routing và Interface Statistics
&lt;/h3&gt;&lt;p&gt;Ngoài socket, &lt;code&gt;netstat&lt;/code&gt; còn dùng để check tầng mạng thấp hơn.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;a. Routing Table (&lt;code&gt;netstat -r&lt;/code&gt; hoặc &lt;code&gt;netstat -rn&lt;/code&gt;)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Tương đương lệnh &lt;code&gt;route -n&lt;/code&gt; hoặc &lt;code&gt;ip route&lt;/code&gt;.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Dùng để kiểm tra Default Gateway (&lt;code&gt;0.0.0.0&lt;/code&gt;) có đúng không khi server không ra được internet.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;b. Interface Statistics (&lt;code&gt;netstat -i&lt;/code&gt;)&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Iface      MTU    RX-OK RX-ERR RX-DRP RX-OVR    TX-OK TX-ERR TX-DRP TX-OVR Flg
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;eth0      &lt;span class=&#34;m&#34;&gt;1500&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;12345&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;    &lt;span class=&#34;m&#34;&gt;12345&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; BMRU
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;RX-ERR / TX-ERR:&lt;/strong&gt; Nếu số này tăng, có thể do cáp mạng hỏng, switch lỗi hoặc duplex mismatch.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;RX-DRP (Drop):&lt;/strong&gt; Server quá tải, CPU không xử lý kịp gói tin, hoặc firewall (iptables) đang drop gói tin.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;6-sự-chuyển-dịch-netstat-vs-ss-socket-statistics&#34;&gt;6. Sự chuyển dịch: Netstat vs. SS (Socket Statistics)
&lt;/h3&gt;&lt;p&gt;Đây là kiến thức phân biệt giữa Junior và Senior.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Netstat:&lt;/strong&gt; Đọc thông tin từ &lt;code&gt;/proc/net/tcp&lt;/code&gt;. Khi hệ thống có hàng chục nghìn kết nối, việc đọc file này rất chậm và tốn CPU.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;SS (&lt;code&gt;iproute2&lt;/code&gt; package):&lt;/strong&gt; Lấy thông tin trực tiếp từ kernel space qua &lt;strong&gt;Netlink API&lt;/strong&gt;. Nhanh hơn rất nhiều.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Bảng chuyển đổi cho DevOps:&lt;/strong&gt;&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th style=&#34;text-align: left&#34;&gt;Mục đích&lt;/th&gt;
          &lt;th style=&#34;text-align: left&#34;&gt;Lệnh Netstat (Cũ)&lt;/th&gt;
          &lt;th style=&#34;text-align: left&#34;&gt;Lệnh SS (Mới - Khuyên dùng)&lt;/th&gt;
          &lt;th&gt;&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;Xem tất cả TCP/UDP port đang listen&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;&lt;code&gt;netstat -tulpn&lt;/code&gt;&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;&lt;code&gt;ss -tulpn&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;Xem kết nối đã thiết lập&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;&lt;code&gt;netstat -atn&lt;/code&gt;&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;&lt;code&gt;ss -atn&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;Xem tóm tắt thống kê (Summary)&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;&lt;code&gt;netstat -s&lt;/code&gt;&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;&lt;code&gt;ss -s&lt;/code&gt; (Rất gọn và đẹp)&lt;/td&gt;
          &lt;td&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;Lọc theo port&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;&lt;code&gt;netstat -an | grep :80&lt;/code&gt;&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;&lt;code&gt;ss -tn sport = :80&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3 id=&#34;7-tổng-kết-checklist-cho-devops-engineer&#34;&gt;7. Tổng kết: Checklist cho DevOps Engineer
&lt;/h3&gt;&lt;p&gt;Khi sử dụng &lt;code&gt;netstat&lt;/code&gt;, hãy luôn nhớ quy trình tư duy này:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Check Listening:&lt;/strong&gt; Service có chạy và bind đúng IP/Port không? (&lt;code&gt;-tulpn&lt;/code&gt;)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Check Connection:&lt;/strong&gt; Ai đang kết nối vào? (&lt;code&gt;-an&lt;/code&gt;)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Check State:&lt;/strong&gt; Có bị leak connection (&lt;code&gt;CLOSE_WAIT&lt;/code&gt;) hay cạn resource (&lt;code&gt;TIME_WAIT&lt;/code&gt;) không?&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Check Bottleneck:&lt;/strong&gt; Có IP nào spam kết nối không? (Dùng &lt;code&gt;awk&lt;/code&gt; để lọc).&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Performance:&lt;/strong&gt; Nếu server tải cao, hãy chuyển sang dùng &lt;code&gt;ss&lt;/code&gt; thay vì &lt;code&gt;netstat&lt;/code&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;</description>
        </item>
        <item>
        <title>Tổng quan về mô hình OSI</title>
        <link>https://blog.nagih.io.vn/posts/networking/osi/</link>
        <pubDate>Sun, 12 Oct 2025 00:00:00 +0000</pubDate>
        
        <guid>https://blog.nagih.io.vn/posts/networking/osi/</guid>
        <description>&lt;p&gt;Open Systems Interconnection - OSI là một khung khái niệm chia các chức năng truyền thông mạng thành 7 lớp hay 7 tầng riêng biệt. Được phát triển bởi Tổ chức Tiêu chuẩn hóa Quốc tế (ISO)&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;cấu-trúc-7-tầng-của-mô-hình-osi&#34;&gt;Cấu trúc 7 tầng của mô hình OSI
&lt;/h2&gt;&lt;p&gt;Quá trình truyền dữ liệu trong mô hình OSI diễn ra theo thứ tự từ tầng ứng dụng (tầng 7) đi xuống tầng vật lý (tầng 1) ở máy gửi, và ngược lại ở máy nhận. Mỗi tầng có những chức năng cụ thể và có thêm thêm header (thông tin điều khiển) của riêng mình vào dữ liệu trước khi chuyển xuống tầng tiếp theo. Quá trình này gọi là &amp;ldquo;đóng gói dữ liệu&amp;rdquo;.&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;tầng-7-application-layer&#34;&gt;Tầng 7: Application Layer
&lt;/h3&gt;&lt;p&gt;Đây là tầng gần gũi nhất với người dùng. Nó cung cấp giao diện để các ứng dụng phần mềm có thể truy cập và sử dụng các dịch vụ mạng.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Chức năng chính:&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Cung cấp các dịch vụ mạng cho ứng dụng của người dùng như truy cập web, gửi/nhận email, truyền file.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Xác định các giao thức mà ứng dụng sử dụng để trao đổi dữ liệu.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Ví dụ thực tế:&lt;/strong&gt; Khi bạn sử dụng trình duyệt web, email hoặc một phần mềm chat, bạn đang tương tác với tầng ứng dụng. Các giao thức phổ biến ở tầng này bao gồm HTTP/HTTPS (truy cập web), FTP (truyền tệp), SMTP (gửi email), và DNS (hệ thống phân giải tên miền).&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;tầng-6-presentation-layer&#34;&gt;Tầng 6: Presentation Layer
&lt;/h3&gt;&lt;p&gt;Tầng này hoạt động như một &amp;ldquo;người phiên dịch&amp;rdquo; của mạng, đảm bảo rằng dữ liệu được gửi từ tầng ứng dụng của một hệ thống có thể được đọc và hiểu bởi tầng ứng dụng của hệ thống khác.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Chức năng chính:&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Định dạng dữ liệu:&lt;/strong&gt; Chuyển đổi dữ liệu sang một định dạng chung mà mạng có thể hiểu.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Mã hóa và giải mã:&lt;/strong&gt; Đảm bảo tính bảo mật và bí mật của dữ liệu trong quá trình truyền.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Nén và giải nén:&lt;/strong&gt; Giảm kích thước dữ liệu để truyền đi nhanh hơn và tiết kiệm băng thông.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Ví dụ thực tế:&lt;/strong&gt; Mã hóa HTTPS thông qua SSL/TLS thường được coi là hoạt động ở tầng này. Các định dạng tệp hình ảnh (JPEG, GIF) và video (MPEG) cũng là ví dụ về hoạt động của tầng trình bày.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;tầng-5-session-layer&#34;&gt;Tầng 5: Session Layer
&lt;/h3&gt;&lt;p&gt;Tầng này chịu trách nhiệm thiết lập, quản lý và kết thúc các phiên giao tiếp (kết nối) giữa hai máy tính.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Chức năng chính:&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Thiết lập và quản lý phiên:&lt;/strong&gt; Tạo, duy trì và đồng bộ hóa các phiên giao tiếp giữa các ứng dụng.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Điều khiển đối thoại:&lt;/strong&gt; Xác định lượt truyền dữ liệu (ai gửi, ai nhận, và trong bao lâu).&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Khôi phục phiên:&lt;/strong&gt; Nếu một phiên bị gián đoạn, tầng này có thể giúp khôi phục lại từ một điểm kiểm tra (checkpoint), tránh việc phải truyền lại toàn bộ dữ liệu.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Ví dụ thực tế:&lt;/strong&gt; Khi bạn thực hiện một cuộc gọi video, tầng phiên sẽ duy trì kết nối ổn định trong suốt cuộc gọi. Các giao thức như NetBIOS, RPC cũng hoạt động ở tầng này.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;tầng-4-transport-layer&#34;&gt;Tầng 4: Transport Layer
&lt;/h3&gt;&lt;p&gt;Tầng vận chuyển đảm bảo việc truyền dữ liệu hoàn chỉnh và đáng tin cậy từ một tiến trình trên máy gửi đến một tiến trình trên máy nhận.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Chức năng chính:&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Phân đoạn và tái lắp ráp:&lt;/strong&gt; Chia nhỏ dữ liệu từ tầng phiên thành các đoạn (segment) nhỏ hơn để truyền đi và tập hợp chúng lại ở phía nhận.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Kiểm soát luồng:&lt;/strong&gt; Điều chỉnh tốc độ truyền dữ liệu để tránh làm quá tải thiết bị nhận.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Kiểm soát lỗi:&lt;/strong&gt; Đảm bảo dữ liệu đến nơi một cách chính xác, không bị lỗi, mất mát hay trùng lặp.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Cung cấp hai loại giao thức chính:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;TCP (Transmission Control Protocol):&lt;/strong&gt; Hướng kết nối, đảm bảo độ tin cậy cao (dữ liệu được gửi đầy đủ và đúng thứ tự). Thích hợp cho việc tải tệp, gửi email.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;UDP (User Datagram Protocol):&lt;/strong&gt; Không kết nối, truyền dữ liệu nhanh hơn nhưng không đảm bảo độ tin cậy. Thích hợp cho streaming video, game online.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;tầng-3-network-layer&#34;&gt;Tầng 3: Network Layer
&lt;/h3&gt;&lt;p&gt;Tầng mạng chịu trách nhiệm cho việc định địa chỉ logic và định tuyến các gói tin (packet) qua các mạng khác nhau để đến đúng đích.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Chức năng chính:&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Định địa chỉ logic (Logical Addressing):&lt;/strong&gt; Gán địa chỉ IP cho các thiết bị để xác định chúng trên mạng.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Định tuyến (Routing):&lt;/strong&gt; Xác định con đường tốt nhất để các gói tin di chuyển từ nguồn đến đích qua nhiều mạng khác nhau. Các thiết bị định tuyến (router) hoạt động ở tầng này.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Ví dụ thực tế:&lt;/strong&gt; Khi bạn truy cập một trang web, tầng mạng sẽ xác định đường đi cho dữ liệu của bạn qua Internet để đến được máy chủ của trang web đó. Giao thức IP (Internet Protocol) là giao thức chính ở tầng này.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;tầng-2-data-link-layer&#34;&gt;Tầng 2: Data Link Layer
&lt;/h3&gt;&lt;p&gt;Tầng này cung cấp phương tiện truyền dữ liệu đáng tin cậy qua một liên kết vật lý trực tiếp. Nó nhận các gói tin từ tầng mạng và đóng gói chúng thành các khung (frame).&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Chức năng chính:&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Định địa chỉ vật lý (Physical Addressing):&lt;/strong&gt; Thêm địa chỉ MAC (Media Access Control) của thiết bị gửi và nhận vào mỗi khung. Địa chỉ MAC là duy nhất cho mỗi card mạng.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Kiểm soát lỗi:&lt;/strong&gt; Phát hiện và sửa lỗi có thể xảy ra ở tầng vật lý.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Kiểm soát truy cập môi trường (Media Access Control - MAC):&lt;/strong&gt; Điều khiển việc các thiết bị trên cùng một mạng chia sẻ truy cập vào môi trường truyền.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Ví dụ thực tế:&lt;/strong&gt; Các thiết bị chuyển mạch (switch) hoạt động ở tầng này. Giao thức Ethernet là một ví dụ điển hình.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;tầng-1-physical-layer&#34;&gt;Tầng 1: Physical Layer
&lt;/h3&gt;&lt;p&gt;Đây là tầng thấp nhất, chịu trách nhiệm truyền các bit dữ liệu (0 và 1) qua môi trường truyền vật lý.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Chức năng chính:&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Định nghĩa các đặc tính vật lý:&lt;/strong&gt; Quy định về các thiết bị phần cứng như cáp mạng, đầu nối, card mạng, cũng như các đặc tính về điện, cơ và quang.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Biểu diễn bit:&lt;/strong&gt; Chuyển đổi các bit 0 và 1 thành các tín hiệu điện, ánh sáng hoặc sóng vô tuyến để truyền đi.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Tốc độ dữ liệu:&lt;/strong&gt; Xác định số bit được truyền đi mỗi giây.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Ví dụ thực tế:&lt;/strong&gt; Cáp đồng, cáp quang, sóng Wi-Fi, hub, và repeater là những ví dụ về các thành phần hoạt động ở tầng vật lý.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;ưu-và-nhược-điểm-của-mô-hình-osi&#34;&gt;Ưu và nhược điểm của mô hình OSI
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Ưu điểm:&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Chuẩn hóa:&lt;/strong&gt; Tạo ra một tiêu chuẩn chung, giúp các nhà sản xuất khác nhau tạo ra các sản phẩm tương thích.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Giảm độ phức tạp:&lt;/strong&gt; Chia nhỏ quá trình truyền thông phức tạp thành các phần đơn giản, dễ quản lý và dễ hiểu hơn.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Hỗ trợ kỹ thuật module:&lt;/strong&gt; Cho phép thay đổi hoặc phát triển công nghệ ở một tầng mà không ảnh hưởng đến các tầng khác.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Dễ dàng khắc phục sự cố:&lt;/strong&gt; Giúp các kỹ sư mạng xác định vấn đề xảy ra ở tầng nào một cách nhanh chóng.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Nhược điểm:&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Tính lý thuyết:&lt;/strong&gt; Mô hình OSI chỉ là một mô hình tham chiếu và không được triển khai rộng rãi trong thực tế như mô hình TCP/IP.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Phức tạp:&lt;/strong&gt; Một số người cho rằng mô hình 7 tầng là quá phức tạp và một số tầng có chức năng không thực sự cần thiết trong nhiều ứng dụng thực tế.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;</description>
        </item>
        
    </channel>
</rss>
