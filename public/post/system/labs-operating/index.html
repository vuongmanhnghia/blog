<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <script type="application/javascript" src='https://blog.nagih.io.vn/js/theme-mode.js'></script>
    <link rel="stylesheet" href='https://blog.nagih.io.vn/css/frameworks.min.css' />
    <link rel="stylesheet" href='https://blog.nagih.io.vn/css/github.min.css' />
    <link rel="stylesheet" href='https://blog.nagih.io.vn/css/github-style.css' />
    <link rel="stylesheet" href='https://blog.nagih.io.vn/css/light.css' />
    <link rel="stylesheet" href='https://blog.nagih.io.vn/css/dark.css' />
    <link rel="stylesheet" href='https://blog.nagih.io.vn/css/syntax.css' />
    <title>Labs Operating - Nagih&#39;s blog</title>
    
    <link rel="icon" type="image/x-icon" href='/images/avatar.png'>
    
    <meta name="theme-color" content="#1e2327">

    <link rel="stylesheet" href="https://blog.nagih.io.vn/css/custom.css">
    <script type="text/javascript" src="https://blog.nagih.io.vn/js/custom.js"></script>

    
    <meta name="description"
  content="1 Số Labs từ Cơ bản tới Nâng cao về Operating
" />
<meta name="keywords"
  content='blog, google analytics' />
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://blog.nagih.io.vn/post/system/labs-operating/" />


<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Labs Operating - Nagih&#39;s blog" />
<meta name="twitter:description"
  content="1 Số Labs từ Cơ bản tới Nâng cao về Operating
" />
<meta name="twitter:site" content="https://blog.nagih.io.vn/" />
<meta name="twitter:creator" content="" />
<meta name="twitter:image"
  content="https://blog.nagih.io.vn/">


<meta property="og:type" content="article" />
<meta property="og:title" content="Labs Operating - Nagih&#39;s blog">
<meta property="og:description"
  content="1 Số Labs từ Cơ bản tới Nâng cao về Operating
" />
<meta property="og:url" content="https://blog.nagih.io.vn/post/system/labs-operating/" />
<meta property="og:site_name" content="Labs Operating" />
<meta property="og:image"
  content="https://blog.nagih.io.vn/">
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">

<meta property="article:published_time" content="2025-08-23 00:00:00 &#43;0000 UTC" />













</head>


<body>
  <div style="position: relative">
	<header
		class="Header js-details-container Details px-3 px-md-4 px-lg-5 flex-wrap flex-md-nowrap open Details--on">
		<div
			class="Header-item mobile-none"
			style="margin-top: -4px; margin-bottom: -4px">
			<a class="Header-link" href="https://blog.nagih.io.vn/">
				<img
					class="octicon"
					height="32"
					width="32"
					src="https://avatars.githubusercontent.com/u/123850496?v=4" />
			</a>
		</div>
		<div class="Header-item d-md-none">
			<button
				class="Header-link btn-link js-details-target"
				type="button"
				onclick="document.querySelector('#header-search').style.display = document.querySelector('#header-search').style.display == 'none'? 'block': 'none'">
				<svg
					height="24"
					class="octicon octicon-three-bars"
					viewBox="0 0 16 16"
					version="1.1"
					width="24">
					<path
						fill-rule="evenodd"
						d="M1 2.75A.75.75 0 011.75 2h12.5a.75.75 0 110 1.5H1.75A.75.75 0 011 2.75zm0 5A.75.75 0 011.75 7h12.5a.75.75 0 110 1.5H1.75A.75.75 0 011 7.75zM1.75 12a.75.75 0 100 1.5h12.5a.75.75 0 100-1.5H1.75z"></path>
				</svg>
			</button>
		</div>
		<div
			style="display: none"
			id="header-search"
			class="Header-item Header-item--full flex-column flex-md-row width-full flex-order-2 flex-md-order-none mr-0 mr-md-3 mt-3 mt-md-0 Details-content--hidden-not-important d-md-flex">
			<div
				class="Header-search header-search flex-auto js-site-search position-relative flex-self-stretch flex-md-self-auto mb-3 mb-md-0 mr-0 mr-md-3 scoped-search site-scoped-search js-jump-to">
				<div class="position-relative">
					
					<form
						id="search-form"
						action=""
						accept-charset="UTF-8"
						method="get"
						autocomplete="off">
						<label
							class="Header-search-label form-control input-sm header-search-wrapper p-0 js-chromeless-input-container header-search-wrapper-jump-to position-relative d-flex flex-justify-between flex-items-center">
							<input
								type="text"
								class="Header-search-input form-control input-sm header-search-input jump-to-field js-jump-to-field js-site-search-focus js-site-search-field is-clearable"
								name="q"
								value=""
								placeholder="Search"
								autocomplete="off" />
						</label>
					</form>
					
				</div>
			</div>
		</div>

		<div
			class="Header-item Header-item--full flex-justify-center d-md-none position-relative">
			<a class="Header-link" href="https://blog.nagih.io.vn/">
				<img
					class="octicon octicon-mark-github v-align-middle"
					height="32"
					width="32"
					src="https://avatars.githubusercontent.com/u/123850496?v=4" />
			</a>
		</div>
		<div class="Header-item" style="margin-right: 0">
			<a
				href="javascript:void(0)"
				class="Header-link no-select"
				onclick="switchTheme()">
				<svg
					style="fill: var(--color-profile-color-modes-toggle-moon)"
					class="no-select"
					viewBox="0 0 16 16"
					version="1.1"
					width="16"
					height="16">
					<path
						fill-rule="evenodd"
						clip-rule="evenodd"
						d="M4.52208 7.71754C7.5782 7.71754 10.0557 5.24006 10.0557 2.18394C10.0557 1.93498 10.0392 1.68986 10.0074 1.44961C9.95801 1.07727 10.3495 0.771159 10.6474 0.99992C12.1153 2.12716 13.0615 3.89999 13.0615 5.89383C13.0615 9.29958 10.3006 12.0605 6.89485 12.0605C3.95334 12.0605 1.49286 10.001 0.876728 7.24527C0.794841 6.87902 1.23668 6.65289 1.55321 6.85451C2.41106 7.40095 3.4296 7.71754 4.52208 7.71754Z"></path>
				</svg>
			</a>
		</div>
	</header>
</div>

  <div id="search-result" class="container-lg px-3 new-discussion-timeline" style="display: none;">
</div>

  
<div class="application-main">
  <div>
  <main>
    <div class="gisthead pagehead bg-gray-light pb-0 pt-3 mb-4">
      <div class="px-0">
        <div class="mb-3 d-flex px-3 px-md-3 px-lg-5">
          <div class="flex-auto min-width-0 width-fit mr-3">
            <div class="d-flex">
              <div class="d-none d-md-block">
                <a class="avatar mr-2 flex-shrink-0" href="https://blog.nagih.io.vn/">
                  <img class=" avatar-user"
                    src="https://avatars.githubusercontent.com/u/123850496?v=4"
                    width="32" height="32"></a>
              </div>
              <div class="d-flex flex-column">
                <h1 class="break-word f3 text-normal mb-md-0 mb-1">
                  <span class="author">
                    <strong>
                      <a href="https://blog.nagih.io.vn/">Nagih</a>
                    </strong>
                  </span>
                  <span class="path-divider">/</span>
                  <strong class="css-truncate css-truncate-target mr-1" style="max-width: 410px">
                    <a href="https://blog.nagih.io.vn/post/system/labs-operating/">Labs Operating</a>
                  </strong>
                </h1>
                <div class="note m-0">
                  Created <relative-time datetime="Sat, 23 Aug 2025 00:00:00 &#43;0000"
                    class="no-wrap">
                    Sat, 23 Aug 2025 00:00:00 &#43;0000</relative-time>

                  
                  <span class="file-info-divider"></span>
                  Modified <relative-time datetime="Thu, 28 Aug 2025 15:52:39 &#43;0700"
                    class="no-wrap">
                    Thu, 28 Aug 2025 15:52:39 &#43;0700</relative-time>
                  
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container-lg px-3 new-discussion-timeline">
      <div class="repository-content gist-content">
        <div>
          <div class="js-gist-file-update-container js-task-list-container file-box">
            <div id="file-pytest" class="file my-2">
              <div id="post-header" class="file-header d-flex flex-md-items-center flex-items-start sticky-header" style="z-index: 2">
                <div class="file-info d-flex flex-md-items-center flex-items-start flex-order-1 flex-auto">
                  <div class="text-mono f6 flex-auto pr-3 flex-order-2 flex-md-order-1 mt-2 mt-md-0">
                    
                    <summary id="toc-toggle" onclick="clickToc()" class="btn btn-octicon m-0 mr-2 p-2">
                      <svg aria-hidden="true" viewBox="0 0 16 16" height="16" width="16" class="octicon octicon-list-unordered">
                        <path fill-rule="evenodd" d="M2 4a1 1 0 100-2 1 1 0 000 2zm3.75-1.5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zm0 5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zm0 5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zM3 8a1 1 0 11-2 0 1 1 0 012 0zm-1 6a1 1 0 100-2 1 1 0 000 2z"></path>
                      </svg>
                    </summary>
                    <details-menu class="SelectMenu" id="toc-details" style="display: none;">
                      <div class="SelectMenu-modal rounded-3 mt-1" style="max-height: 340px;">
                        <div class="SelectMenu-list SelectMenu-list--borderless p-2" style="overscroll-behavior: contain;" id="toc-list">
                        </div>
                      </div>
                    </details-menu>
                      3639 Words
                    

                  </div>
                  <div class="file-actions flex-order-2 pt-0">
                    
                    
                    <a class="muted-link mr-3" href="/tags/system">
                      <svg class="octicon octicon-tag" viewBox="0 0 16 16" version="1.1" width="16" height="16">
                        <path fill-rule="evenodd"
                          d="M2.5 7.775V2.75a.25.25 0 01.25-.25h5.025a.25.25 0 01.177.073l6.25 6.25a.25.25 0 010 .354l-5.025 5.025a.25.25 0 01-.354 0l-6.25-6.25a.25.25 0 01-.073-.177zm-1.5 0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 010 2.474l-5.026 5.026a1.75 1.75 0 01-2.474 0l-6.25-6.25A1.75 1.75 0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z">
                        </path>
                      </svg>
                      system
                    </a>
                    
                    <a class="muted-link mr-3" href="/tags/network">
                      <svg class="octicon octicon-tag" viewBox="0 0 16 16" version="1.1" width="16" height="16">
                        <path fill-rule="evenodd"
                          d="M2.5 7.775V2.75a.25.25 0 01.25-.25h5.025a.25.25 0 01.177.073l6.25 6.25a.25.25 0 010 .354l-5.025 5.025a.25.25 0 01-.354 0l-6.25-6.25a.25.25 0 01-.073-.177zm-1.5 0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 010 2.474l-5.026 5.026a1.75 1.75 0 01-2.474 0l-6.25-6.25A1.75 1.75 0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z">
                        </path>
                      </svg>
                      network
                    </a>
                    
                    
                  </div>
                </div>
              </div>


              <div class="Box-body px-5 pb-5" style="z-index: 1">
                <article class="markdown-body entry-content container-lg"><p>1 Số Labs từ Cơ bản tới Nâng cao về Operating</p>
<h2 id="tại-sao-hệ-điều-hành-vẫn-quan-trọng-trong-thế-giới-cloud-native">Tại sao Hệ Điều Hành Vẫn Quan Trọng trong Thế Giới Cloud-Native</h2>
<p>Trong lĩnh vực DevOps hiện đại, tồn tại một nghịch lý: trong khi các công cụ cấp cao như Kubernetes, Docker và Ansible trừu tượng hóa hệ điều hành bên dưới, việc hiểu sâu về Linux lại trở nên quan trọng hơn bao giờ hết. Hầu hết các công cụ DevOps cốt lõi đều được xây dựng để chạy tốt nhất trên Linux, biến nó thành nền tảng phổ biến cho cơ sở hạ tầng đám mây và tự động hóa.</p>
<p>Hướng dẫn này được thiết kế để nâng tầm kỹ sư từ một người dùng đơn thuần các công cụ này trở thành một kiến trúc sư hiểu rõ hoạt động bên trong của chúng. Hệ điều hành Linux không nên được xem như một hệ thống cũ kỹ, mà là &ldquo;API&rdquo; nền tảng, phổ quát cho mọi hoạt động tự động hóa cơ sở hạ tầng. Tám bài lab dưới đây được cấu trúc như một hành trình có phương pháp, phản ánh quy trình xử lý sự cố trong thực tế, bắt đầu từ các kiểm tra hệ thống cơ bản, đi sâu dần vào phân tích hiệu năng, gỡ lỗi nâng cao và cuối cùng là các nguyên tắc cốt lõi của container hóa. Đây không chỉ là một bộ sưu tập các lệnh; nó là một mô hình tư duy về hệ thống.</p>
<h2 id="lab-1-điều-hướng-và-quản-lý-hệ-thống-tệp">Lab 1: Điều Hướng và Quản Lý Hệ Thống Tệp</h2>
<p><strong>Mục tiêu:</strong> Xây dựng &ldquo;trí nhớ cơ bắp&rdquo; để điều hướng hệ thống tệp Linux và thực hiện các thao tác tệp thiết yếu. Đây là nền tảng để tìm kiếm log, quản lý tệp cấu hình và chuẩn bị các tạo phẩm ứng dụng cho việc triển khai.</p>
<h3 id="các-khái-niệm-cốt-lõi">Các Khái Niệm Cốt Lõi</h3>
<ul>
<li>
<p><strong>Triết lý &ldquo;Mọi thứ đều là tệp&rdquo;:</strong> Trong Linux, một nguyên tắc cốt lõi là mọi thứ, từ thiết bị phần cứng, socket mạng đến các thư mục, đều được biểu diễn dưới dạng tệp. Điều này cung cấp một giao diện thống nhất để tương tác với toàn bộ hệ thống.</p>
</li>
<li>
<p><strong>Tiêu chuẩn Phân cấp Hệ thống tệp (FHS):</strong> Cấu trúc thư mục trong Linux tuân theo một tiêu chuẩn, mang lại sự dễ đoán trong quản trị hệ thống. Các thư mục chính bao gồm <code>/etc</code> cho các tệp cấu hình, <code>/var/log</code> cho các tệp nhật ký, <code>/home</code> cho thư mục người dùng và <code>/usr</code> cho các tiện ích và ứng dụng hệ thống.</p>
</li>
</ul>
<h3 id="thực-hành-từng-bước">Thực Hành (Từng bước)</h3>
<ol>
<li>
<p><strong>Bước 1: Xác định vị trí:</strong> Sử dụng lệnh <code>pwd</code> để in ra thư mục làm việc hiện tại và <code>whoami</code> để xác định người dùng hiện tại.</p>
</li>
<li>
<p><strong>Bước 2: Khám phá xung quanh:</strong> Sử dụng <code>ls</code> với các cờ phổ biến (<code>-l</code>, <code>-a</code>, <code>-h</code>) để liệt kê nội dung thư mục và hiểu định dạng đầu ra (quyền, chủ sở hữu, kích thước, ngày).</p>
</li>
<li>
<p><strong>Bước 3: Di chuyển:</strong> Thực hành điều hướng bằng <code>cd</code>, sử dụng cả đường dẫn tuyệt đối (ví dụ: <code>cd /var/log</code>) và tương đối (ví dụ: <code>cd../..</code>).</p>
</li>
<li>
<p><strong>Bước 4: Tạo và Xóa:</strong> Sử dụng <code>touch</code> để tạo các tệp trống, <code>mkdir</code> để tạo thư mục (và <code>-p</code> để tạo các thư mục cha), và <code>rm</code> để xóa tệp và thư mục (<code>-r</code> để xóa đệ quy).</p>
</li>
<li>
<p><strong>Bước 5: Thao tác với tệp:</strong> Sử dụng <code>cp</code> để sao chép, <code>mv</code> để di chuyển/đổi tên, và <code>cat</code> để hiển thị nội dung tệp.</p>
</li>
</ol>
<table>
  <thead>
      <tr>
          <th>Lệnh</th>
          <th>Trường Hợp Sử Dụng Phổ Biến</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>ls</code></td>
          <td>Liệt kê nội dung của một thư mục.</td>
      </tr>
      <tr>
          <td><code>cd</code></td>
          <td>Thay đổi thư mục làm việc hiện tại.</td>
      </tr>
      <tr>
          <td><code>pwd</code></td>
          <td>In ra đường dẫn đầy đủ của thư mục hiện tại.</td>
      </tr>
      <tr>
          <td><code>mkdir</code></td>
          <td>Tạo một thư mục mới.</td>
      </tr>
      <tr>
          <td><code>rm</code></td>
          <td>Xóa tệp hoặc thư mục.</td>
      </tr>
      <tr>
          <td><code>cp</code></td>
          <td>Sao chép tệp hoặc thư mục.</td>
      </tr>
      <tr>
          <td><code>mv</code></td>
          <td>Di chuyển hoặc đổi tên tệp hoặc thư mục.</td>
      </tr>
      <tr>
          <td><code>touch</code></td>
          <td>Tạo một tệp trống hoặc cập nhật dấu thời gian của tệp.</td>
      </tr>
      <tr>
          <td><code>cat</code></td>
          <td>Hiển thị nội dung của một tệp.</td>
      </tr>
      <tr>
          <td><code>head</code> / <code>tail</code></td>
          <td>Hiển thị phần đầu hoặc phần cuối của một tệp.</td>
      </tr>
  </tbody>
</table>
<h2 id="lab-2-quản-lý-người-dùng-nhóm-và-quyền-truy-cập">Lab 2: Quản Lý Người Dùng, Nhóm và Quyền Truy Cập</h2>
<p><strong>Mục tiêu:</strong> Bảo mật tài nguyên hệ thống bằng cách làm chủ quyền sở hữu tệp và các danh sách kiểm soát truy cập. Kỹ năng này có thể áp dụng trực tiếp vào việc bảo mật môi trường tác tử CI/CD, thiết lập quyền cho các tạo phẩm triển khai và cấu hình quyền truy cập của người dùng trên máy chủ.</p>
<h3 id="các-khái-niệm-cốt-lõi-1">Các Khái Niệm Cốt Lõi</h3>
<ul>
<li>
<p><strong>Bộ ba Bảo mật:</strong> Mô hình quyền trong Linux dựa trên ba thực thể: <code>user</code> (người dùng, chủ sở hữu), <code>group</code> (nhóm), và <code>other</code> (những người khác).</p>
</li>
<li>
<p><strong>Giải mã Quyền:</strong> Mỗi thực thể có thể được cấp ba loại quyền cơ bản: <code>read (r)</code> (đọc), <code>write (w)</code> (ghi), và <code>execute (x)</code> (thực thi). Ý nghĩa của các quyền này khác nhau giữa tệp và thư mục. Ví dụ, quyền <code>execute</code> trên một thư mục cho phép người dùng <code>cd</code> vào thư mục đó, trong khi trên một tệp, nó cho phép chạy tệp đó như một chương trình.</p>
</li>
</ul>
<h3 id="thực-hành-từng-bước-1">Thực Hành (Từng bước)</h3>
<ol>
<li>
<p><strong>Bước 1: Quản trị Người dùng và Nhóm:</strong> Tạo một người dùng mới với <code>useradd</code>, đặt mật khẩu với <code>passwd</code>, và tạo một nhóm mới với <code>groupadd</code>. Thêm người dùng vào nhóm vừa tạo.</p>
</li>
<li>
<p><strong>Bước 2: Thay đổi Quyền sở hữu:</strong> Sử dụng <code>chown</code> để thay đổi chủ sở hữu của một tệp và <code>chgrp</code> (hoặc <code>chown user:group</code>) để thay đổi nhóm sở hữu. Luôn sử dụng</p>
<p><code>sudo</code> cho các hoạt động này khi cần thiết.</p>
</li>
<li>
<p><strong>Bước 3: Sửa đổi Quyền bằng Ký hiệu Tượng trưng:</strong> Sử dụng <code>chmod</code> với ký hiệu tượng trưng (<code>u+x</code>, <code>g-w</code>, <code>o=r</code>) để thay đổi quyền một cách chi tiết và dễ đọc.</p>
</li>
<li>
<p><strong>Bước 4: Sửa đổi Quyền bằng Ký hiệu Bát phân (Số):</strong> Giới thiệu các giá trị số (r=4, w=2, x=1) và trình bày cách thiết lập các quyền phổ biến như <code>chmod 755</code> cho các tập lệnh và <code>chmod 644</code> cho các tệp web.</p>
</li>
</ol>
<table>
  <thead>
      <tr>
          <th>Giá trị Bát phân</th>
          <th>Ký hiệu Tượng trưng</th>
          <th>Trường Hợp Sử Dụng Phổ Biến</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>777</code></td>
          <td><code>rwxrwxrwx</code></td>
          <td>Không an toàn, chỉ dùng cho mục đích tạm thời hoặc trong môi trường được kiểm soát chặt chẽ.</td>
      </tr>
      <tr>
          <td><code>755</code></td>
          <td><code>rwxr-xr-x</code></td>
          <td>Các tập lệnh thực thi, các thư mục cần người khác truy cập.</td>
      </tr>
      <tr>
          <td><code>644</code></td>
          <td><code>rw-r--r--</code></td>
          <td>Các tệp nội dung web, tệp cấu hình chỉ đọc cho người khác.</td>
      </tr>
      <tr>
          <td><code>600</code></td>
          <td><code>rw-------</code></td>
          <td>Các tệp nhạy cảm như khóa riêng SSH, chỉ chủ sở hữu mới có thể đọc/ghi.</td>
      </tr>
  </tbody>
</table>
<h2 id="lab-3-quản-lý-tiến-trình-và-giám-sát-thời-gian-thực">Lab 3: Quản Lý Tiến Trình và Giám Sát Thời Gian Thực</h2>
<p><strong>Mục tiêu:</strong> Học cách xem những gì đang chạy trên hệ thống, diễn giải việc sử dụng tài nguyên và quản lý các tiến trình hoạt động sai. Đây là tuyến phòng thủ đầu tiên khi khắc phục sự cố một ứng dụng chạy chậm hoặc không phản hồi, ngay cả bên trong một container.</p>
<h3 id="các-khái-niệm-cốt-lõi-2">Các Khái Niệm Cốt Lõi</h3>
<ul>
<li><strong>Vòng đời Tiến trình:</strong> Một tiến trình là một thực thể của một chương trình đang chạy. Mỗi tiến trình có một Mã định danh Tiến trình (PID) duy nhất và có thể ở các trạng thái khác nhau như đang chạy (running), đang ngủ (sleeping), hoặc zombie (xác sống).</li>
</ul>
<h3 id="thực-hành-từng-bước-2">Thực Hành (Từng bước)</h3>
<ol>
<li>
<p><strong>Bước 1: Liệt kê Tiến trình Tĩnh:</strong> Sử dụng <code>ps aux</code> để có một ảnh chụp nhanh chi tiết về tất cả các tiến trình đang chạy. Phân tích các cột chính: <code>USER</code>, <code>PID</code>, <code>%CPU</code>, <code>%MEM</code>, <code>COMMAND</code>.</p>
</li>
<li>
<p><strong>Bước 2: Giám sát Thời gian thực với <code>top</code>:</strong> Khởi chạy <code>top</code> và giải thích khu vực tóm tắt (tải trung bình, tác vụ, trạng thái CPU, bộ nhớ) và danh sách tiến trình tương tác. Trình bày cách sắp xếp theo bộ nhớ (<code>M</code>) và CPU (<code>P</code>).</p>
</li>
<li>
<p><strong>Bước 3: Giám sát Nâng cao với <code>htop</code>:</strong> Giới thiệu <code>htop</code> như một giải pháp thay thế thân thiện và tương tác hơn cho <code>top</code>. Hướng dẫn người dùng qua các tính năng chính của nó: hiển thị mã màu, cuộn dễ dàng, chế độ xem cây (<code>F5</code>), tìm kiếm (<code>F3</code>), và sắp xếp (<code>F6</code>).</p>
</li>
<li>
<p><strong>Bước 4: Chấm dứt Tiến trình:</strong> Sử dụng lệnh <code>kill</code> với PID để gửi tín hiệu. Giải thích sự khác biệt giữa <code>SIGTERM</code> (chấm dứt nhẹ nhàng, <code>kill &lt;PID&gt;</code>) và <code>SIGKILL</code> (chấm dứt cưỡng bức, <code>kill -9 &lt;PID&gt;</code>). Trình bày cách chấm dứt một tiến trình trực tiếp từ <code>htop</code> (<code>F9</code>).</p>
</li>
</ol>
<p>Các kỹ năng trong bài lab này không chỉ dành cho các máy chủ truyền thống; chúng là những công cụ chính để gỡ lỗi bên trong một container đang chạy. Khi một container sử dụng quá nhiều CPU hoặc bộ nhớ, quy trình chẩn đoán tiêu chuẩn là <code>docker exec -it &lt;container_id&gt; bash</code> theo sau là <code>htop</code> hoặc <code>ps aux</code>. Kubernetes hoặc Docker có thể cho biết <em>rằng</em> một container không khỏe mạnh, nhưng để tìm ra <em>lý do tại sao</em>, cần phải kiểm tra không gian tiến trình bị cô lập bên trong nó bằng chính các công cụ đã học.</p>
<h2 id="lab-4-phân-tích-hiệu-năng-bộ-nhớ-và-io-đĩa">Lab 4: Phân Tích Hiệu Năng Bộ Nhớ và I/O Đĩa</h2>
<p><strong>Mục tiêu:</strong> Vượt ra ngoài việc giám sát CPU để chẩn đoán hai trong số những nút thắt hiệu năng phổ biến nhất: áp lực bộ nhớ và I/O đĩa chậm.</p>
<h3 id="các-khái-niệm-cốt-lõi-3">Các Khái Niệm Cốt Lõi</h3>
<ul>
<li>
<p><strong>Mô hình Bộ nhớ Linux:</strong> Giải thích sự khác biệt giữa bộ nhớ <code>used</code> (đã sử dụng) và <code>available</code> (khả dụng), nhấn mạnh vai trò của <code>buff/cache</code>. Giải mã lý do tại sao &ldquo;bộ nhớ trống thấp&rdquo; thường là bình thường trong Linux. Giới thiệu về Bộ nhớ ảo, Hoán đổi (Swapping) và nguy cơ của Trình tiêu diệt Hết bộ nhớ (OOM Killer).</p>
</li>
<li>
<p><strong>Các Chỉ số I/O Đĩa:</strong> Xác định các chỉ số hiệu năng chính (KPI): IOPS (số thao tác mỗi giây), Thông lượng (MB/s), và Độ trễ/<code>await</code> (thời gian cho mỗi thao tác).</p>
</li>
</ul>
<h3 id="thực-hành-từng-bước-3">Thực Hành (Từng bước)</h3>
<ol>
<li>
<p><strong>Bước 1: Phân tích Sử dụng Bộ nhớ:</strong> Sử dụng <code>free -h</code> để có cái nhìn tổng quan dễ đọc về việc sử dụng RAM và swap. Giải thích từng cột (<code>total</code>, <code>used</code>, <code>free</code>, <code>buff/cache</code>, <code>available</code>).</p>
</li>
<li>
<p><strong>Bước 2: Giám sát I/O Đĩa với <code>iostat</code>:</strong> Chạy <code>iostat -x 1</code> để có cái nhìn thời gian thực, mở rộng về các thống kê đĩa. Tập trung vào việc diễn giải các cột quan trọng nhất: <code>r/s</code>, <code>w/s</code> (IOPS), <code>rMB/s</code>, <code>wMB/s</code> (Thông lượng), <code>await</code> (Độ trễ), và <code>%util</code> (Độ bão hòa).</p>
</li>
<li>
<p><strong>Bước 3: Xác định các Tiến trình Gây Tải I/O nặng với <code>iotop</code>:</strong> Sử dụng <code>sudo iotop</code> để xem một giao diện giống <code>top</code> của các tiến trình được xếp hạng theo I/O đĩa hiện tại của chúng. Điều này trả lời trực tiếp câu hỏi, &ldquo;Tiến trình nào đang làm quá tải đĩa?&rdquo;.</p>
</li>
</ol>
<p>Các chỉ số thu thập được trong bài lab này không phải là những con số tùy ý; chúng là dữ liệu thô cung cấp cho các khuôn khổ độ tin cậy cấp cao hơn như &ldquo;Bốn Tín hiệu Vàng&rdquo; của SRE của Google (Độ trễ, Lưu lượng, Lỗi, Độ bão hòa). Việc học cách đo lường chúng tại nguồn là một bước tiến từ quản trị hệ thống đơn thuần sang kỹ thuật đảm bảo độ tin cậy. Ví dụ, cột</p>
<p><code>await</code> trong <code>iostat</code> là một thước đo trực tiếp về <strong>Độ trễ</strong> I/O đĩa. Các cột IOPS và thông lượng là thước đo trực tiếp về <strong>Lưu lượng</strong> đĩa. Cột <code>%util</code> trong <code>iostat</code> và <code>%iowait</code> từ <code>top</code> là các chỉ số trực tiếp về <strong>Độ bão hòa</strong> của đĩa và CPU. Bằng cách hiểu mối liên hệ này, ta có thể chẩn đoán các vấn đề hiệu năng với một tư duy chiến lược, tập trung vào các chỉ số thực sự quan trọng đối với sức khỏe của dịch vụ.</p>
<h2 id="lab-5-các-lệnh-mạng-và-xử-lý-sự-cố-thiết-yếu">Lab 5: Các Lệnh Mạng và Xử Lý Sự Cố Thiết Yếu</h2>
<p><strong>Mục tiêu:</strong> Xây dựng một bộ công cụ mạnh mẽ để chẩn đoán các vấn đề mạng, từ kiểm tra kết nối cơ bản đến kiểm tra các kết nối đang hoạt động và các vấn đề DNS—một công việc hàng ngày trong môi trường microservices.</p>
<h3 id="các-khái-niệm-cốt-lõi-4">Các Khái Niệm Cốt Lõi</h3>
<p>Các khái niệm cơ bản về mạng bao gồm giao diện mạng, địa chỉ IP, cổng và socket, là những thành phần nền tảng cho mọi giao tiếp trên mạng.</p>
<h3 id="thực-hành-từng-bước-4">Thực Hành (Từng bước)</h3>
<ul>
<li>
<p><strong>Bước 1: Kiểm tra Cấu hình Cục bộ:</strong> Sử dụng <code>ip addr</code> (thay thế hiện đại cho <code>ifconfig</code>) để xem các giao diện mạng và địa chỉ IP của chúng.</p>
</li>
<li>
<p><strong>Bước 2: Kiểm tra Kết nối Cơ bản:</strong> Sử dụng <code>ping</code> để kiểm tra khả năng tiếp cận và độ trễ, và <code>traceroute</code> để vạch ra đường đi của gói tin mạng đến một đích.</p>
</li>
<li>
<p><strong>Bước 3: Xử lý Sự cố DNS:</strong> Sử dụng <code>dig</code> và <code>host</code> để truy vấn các bản ghi DNS (A, CNAME, MX) và thực hiện tra cứu ngược. Điều này rất quan trọng để gỡ lỗi các vấn đề phát hiện dịch vụ (service discovery).</p>
</li>
<li>
<p><strong>Bước 4: Kiểm tra các Kết nối Đang hoạt động:</strong> Giới thiệu <code>ss</code> là công cụ thay thế hiện đại, nhanh hơn cho <code>netstat</code>. Sử dụng</p>
<p><code>ss -tulpn</code> để tìm các cổng đang lắng nghe và các tiến trình sử dụng chúng. Đây là chìa khóa để trả lời &ldquo;Ứng dụng của tôi có đang lắng nghe trên đúng cổng không?&rdquo; và &ldquo;Cái gì đang kết nối với dịch vụ của tôi?&rdquo;.</p>
</li>
<li>
<p><strong>Bước 5: Tương tác với Dịch vụ Web:</strong> Sử dụng <code>curl</code> để thực hiện các yêu cầu HTTP, xem các tiêu đề phản hồi (<code>-I</code>), và nhận chi tiết kết nối đầy đủ (<code>-v</code>), rất cần thiết để kiểm tra API và máy chủ web.</p>
</li>
</ul>
<table>
  <thead>
      <tr>
          <th>Lệnh <code>netstat</code> Cũ</th>
          <th>Lệnh <code>ss</code> Hiện Đại</th>
          <th>Mục Đích</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>netstat -tulpn</code></td>
          <td><code>ss -tulpn</code></td>
          <td>Liệt kê tất cả các cổng TCP/UDP đang lắng nghe và các tiến trình liên quan.</td>
      </tr>
      <tr>
          <td><code>netstat -tan</code></td>
          <td><code>ss -tan</code></td>
          <td>Hiển thị tất cả các kết nối TCP (cả đang lắng nghe và đã thiết lập).</td>
      </tr>
      <tr>
          <td><code>netstat -tun</code></td>
          <td><code>ss -tun</code></td>
          <td>Hiển thị tất cả các kết nối TCP và UDP.</td>
      </tr>
  </tbody>
</table>
<h2 id="lab-6-thám-tử---xử-lý-sự-cố-nâng-cao-với-strace">Lab 6: Thám Tử - Xử Lý Sự Cố Nâng Cao với <code>strace</code></h2>
<p><strong>Mục tiêu:</strong> Học cách sử dụng <code>strace</code> như công cụ gỡ lỗi tối thượng để xem chính xác một ứng dụng đang làm gì ở cấp độ lời gọi hệ thống, khi mà log và giám sát không đủ thông tin.</p>
<h3 id="các-khái-niệm-cốt-lõi-5">Các Khái Niệm Cốt Lõi</h3>
<ul>
<li><strong>Ranh giới Kernel-Userspace:</strong> Lời gọi hệ thống (<code>syscalls</code>) là giao diện mà qua đó các ứng dụng yêu cầu dịch vụ từ nhân Linux (ví dụ: mở một tệp, gửi dữ liệu mạng). <code>strace</code> chặn và giải mã các lời gọi này, cung cấp một cái nhìn không bị che giấu về hoạt động của chương trình.</li>
</ul>
<h3 id="thực-hành-từng-bước-5">Thực Hành (Từng bước)</h3>
<ul>
<li>
<p><strong>Bước 1: Truy vết Cơ bản:</strong> Chạy một lệnh đơn giản dưới <code>strace</code> (ví dụ: <code>strace ls</code>) để xem luồng đầu ra và hiểu định dạng của nó.</p>
</li>
<li>
<p><strong>Bước 2: Gắn vào một Tiến trình Đang chạy:</strong> Tìm PID của một tiến trình đang chạy (sử dụng <code>ps</code> hoặc <code>htop</code> từ Lab 3) và gắn vào nó với <code>strace -p &lt;PID&gt;</code>.</p>
</li>
<li>
<p><strong>Bước 3: Lọc Nhiễu:</strong> Sức mạnh thực sự của <code>strace</code> nằm ở khả năng lọc. Trình bày cách truy vết các syscall cụ thể với <code>-e</code>:</p>
<ul>
<li>
<p><strong>Sự cố Truy cập Tệp:</strong> Sử dụng <code>strace -e trace=file &lt;command&gt;</code> để gỡ lỗi các lỗi &ldquo;Permission denied&rdquo; hoặc &ldquo;No such file or directory&rdquo; bằng cách xem chính xác đường dẫn tệp nào đang bị lỗi.</p>
</li>
<li>
<p><strong>Sự cố Mạng:</strong> Sử dụng <code>strace -e trace=network &lt;command&gt;</code> để xem các lời gọi <code>connect</code>, <code>sendto</code>, <code>recvfrom</code>, giúp gỡ lỗi các kết nối mạng chậm hoặc thất bại.</p>
</li>
</ul>
</li>
<li>
<p><strong>Bước 4: Phân tích Hiệu năng:</strong> Giới thiệu cờ <code>-T</code> để hiển thị thời gian đã dành cho mỗi syscall, giúp xác định các nút thắt hiệu năng nơi ứng dụng đang chờ một thao tác I/O chậm.</p>
</li>
</ul>
<p>Log ứng dụng, các chỉ số và tài liệu mô tả những gì một chương trình <em>nên</em> làm. <code>strace</code> tiết lộ những gì nó <em>thực sự</em> đang làm. Nó là nguồn sự thật tối thượng để gỡ lỗi, bỏ qua tất cả các lớp trừu tượng ở cấp độ ứng dụng. Khi các công cụ khác cung cấp thông tin sai lệch hoặc im lặng, <code>strace</code> cung cấp một bản ghi khách quan, không bị lọc về ý định của chương trình, biến nó thành một kỹ năng quan trọng để giải quyết những lỗi &ldquo;không thể&rdquo;.</p>
<h2 id="lab-7-các-thành-phần-xây-dựng-container-namespaces">Lab 7: Các Thành Phần Xây Dựng Container: Namespaces</h2>
<p><strong>Mục tiêu:</strong> Giải mã công nghệ container bằng cách trình bày thực tế cách các namespace của Linux tạo ra môi trường bị cô lập cho các tiến trình, mạng và hệ thống tệp.</p>
<h3 id="các-khái-niệm-cốt-lõi-6">Các Khái Niệm Cốt Lõi</h3>
<ul>
<li>
<p><strong>Namespaces là gì?</strong> Namespaces là một tính năng của nhân Linux giúp phân vùng các tài nguyên hệ thống toàn cục sao cho một tiến trình bên trong một namespace nghĩ rằng nó có một phiên bản riêng của tài nguyên đó (ví dụ: cây tiến trình riêng, ngăn xếp mạng riêng). Đây là cốt lõi của sự cô lập container.</p>
</li>
<li>
<p><strong>Các loại Namespaces:</strong> Các loại namespace chính bao gồm PID (Process ID), Net (Network), MNT (Mount), UTS (Hostname), và User. Bài lab này sẽ tập trung vào namespace Mạng (<code>net</code>) như một ví dụ trực quan nhất.</p>
</li>
</ul>
<h3 id="thực-hành-từng-bước-6">Thực Hành (Từng bước)</h3>
<ul>
<li>
<p><strong>Bước 1: Tạo Network Namespaces:</strong> Sử dụng <code>ip netns add &lt;name&gt;</code> để tạo hai namespace mạng riêng biệt (ví dụ: <code>ns1</code>, <code>ns2</code>).</p>
</li>
<li>
<p><strong>Bước 2: Xác minh Sự cô lập:</strong> Chạy <code>ip netns exec &lt;name&gt; ip addr</code> để cho thấy mỗi namespace chỉ có giao diện <code>lo</code> riêng của nó và đang ở trạng thái <code>DOWN</code>.</p>
</li>
<li>
<p><strong>Bước 3: Tạo một &ldquo;Cáp Mạng Ảo&rdquo;:</strong> Sử dụng <code>ip link add veth-ns1 type veth peer name veth-ns2</code> để tạo một cặp ethernet ảo (một &ldquo;dây cáp mạng&rdquo; ảo).</p>
</li>
<li>
<p><strong>Bước 4: Kết nối các Namespaces:</strong> &ldquo;Cắm&rdquo; mỗi đầu của cáp ảo vào một namespace bằng cách sử dụng <code>ip link set &lt;veth-device&gt; netns &lt;name&gt;</code>.</p>
</li>
<li>
<p><strong>Bước 5: Cấu hình Mạng bị cô lập:</strong> Bên trong mỗi namespace, gán một địa chỉ IP cho giao diện veth (<code>ip netns exec &lt;name&gt; ip addr add...</code>) và bật giao diện lên (<code>ip netns exec &lt;name&gt; ip link set... up</code>).</p>
</li>
<li>
<p><strong>Bước 6: Kiểm tra Giao tiếp:</strong> Sử dụng <code>ip netns exec ns1 ping &lt;ns2_ip&gt;</code> để cho thấy hai môi trường bị cô lập giờ đây có thể giao tiếp với nhau qua mạng riêng của chúng, nhưng vẫn vô hình đối với máy chủ chủ (host).</p>
</li>
</ul>
<h2 id="lab-8-người-quản-lý---quản-lý-tài-nguyên-với-control-groups-cgroups">Lab 8: Người Quản Lý - Quản Lý Tài Nguyên với Control Groups (cgroups)</h2>
<p><strong>Mục tiêu:</strong> Bổ sung cho sự cô lập từ Lab 7, bài lab này trình bày cách sử dụng cgroups để giới hạn tài nguyên (CPU, bộ nhớ) mà một tiến trình có thể tiêu thụ, hoàn thiện bức tranh về container hóa.</p>
<h3 id="các-khái-niệm-cốt-lõi-7">Các Khái Niệm Cốt Lõi</h3>
<ul>
<li>
<p><strong>cgroups là gì?</strong> cgroups (control groups) là một tính năng của nhân Linux để giới hạn, tính toán và ưu tiên việc sử dụng tài nguyên cho một tập hợp các tiến trình. Trong khi namespaces cung cấp</p>
<p><em>sự cô lập</em> (&ldquo;những gì bạn có thể thấy&rdquo;), cgroups cung cấp <em>sự giới hạn</em> (&ldquo;những gì bạn có thể sử dụng&rdquo;).</p>
</li>
<li>
<p><strong>Controllers/Subsystems:</strong> cgroups được quản lý thông qua các hệ thống con như <code>memory</code>, <code>cpu</code>, và <code>blkio</code>, mỗi hệ thống con kiểm soát một tài nguyên cụ thể.</p>
</li>
</ul>
<h3 id="thực-hành-từng-bước-7">Thực Hành (Từng bước)</h3>
<ul>
<li>
<p><strong>Bước 1: Tạo một cgroup:</strong> Sử dụng <code>cgcreate -g memory,cpu:/my-app-group</code> để tạo một cgroup mới được quản lý bởi các controller bộ nhớ và CPU. Hoặc, có thể tạo thư mục thủ công trong hệ thống tệp ảo</p>
<p><code>/sys/fs/cgroup/</code>.</p>
</li>
<li>
<p><strong>Bước 2: Đặt Giới hạn Bộ nhớ:</strong> Sử dụng <code>echo &quot;100M&quot; &gt; /sys/fs/cgroup/memory/my-app-group/memory.limit_in_bytes</code> để đặt giới hạn bộ nhớ 100MB.</p>
</li>
<li>
<p><strong>Bước 3: Đặt Giới hạn CPU:</strong> Trình bày cách đặt hạn ngạch CPU. Ví dụ, <code>echo 50000 &gt;.../cpu.cfs_quota_us</code> và <code>echo 100000 &gt;.../cpu.cfs_period_us</code> để giới hạn tiến trình ở mức 50% của một lõi CPU.</p>
</li>
<li>
<p><strong>Bước 4: Chạy một Tiến trình trong cgroup:</strong> Sử dụng <code>cgexec -g memory,cpu:/my-app-group &lt;command&gt;</code> để chạy một tiến trình trong các giới hạn này.</p>
</li>
<li>
<p><strong>Bước 5: Quan sát Giới hạn:</strong> Giám sát tiến trình bằng <code>htop</code> và xem nó bị điều tiết (CPU) hoặc bị OOM killer chấm dứt khi vượt quá giới hạn bộ nhớ. Kiểm tra các tệp kế toán của cgroup (<code>memory.usage_in_bytes</code>, <code>memory.failcnt</code>) để thấy việc thực thi giới hạn trong thực tế.</p>
</li>
</ul>
<p>Các bài lab 7 và 8 không chỉ là các bài tập lý thuyết; chúng là một minh chứng thực tế về những gì Kubernetes làm &ldquo;dưới mui xe&rdquo; mỗi khi nó lập lịch cho một Pod. Sự cô lập mạng của một Pod là một network namespace. Dòng <code>resources: { limits: { memory: &quot;100Mi&quot; } }</code> trong tệp YAML của Pod được dịch trực tiếp thành một cấu hình cgroup trên node. Do đó, việc gỡ lỗi một Pod bị OOMKilled trong Kubernetes về cơ bản là việc hiểu sự tương tác giữa ứng dụng và giới hạn bộ nhớ cgroup do Kubelet áp đặt. Hướng dẫn này kết nối tệp YAML trừu tượng của Kubernetes với các tính năng cụ thể của nhân Linux, trao quyền cho kỹ sư để suy luận về hành vi của container từ các nguyên tắc cơ bản, giúp họ trở thành một người vận hành và xử lý sự cố Kubernetes hiệu quả hơn nhiều.</p>
<hr>
<p><em>Nếu thấy hay, hãy để lại cho mình 1 comment xuống phía dưới để mình có động lực viết các blog chất lượng tiếp theo nhé!</em></p></article>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>
<script type="application/javascript" src='https://blog.nagih.io.vn/js/toc.js'></script>
<link rel="stylesheet" href='https://blog.nagih.io.vn/css/toc.css' />

  
<div id="gitalk-container" class="gitalk-container"></div>
<link rel="stylesheet" href='https://blog.nagih.io.vn/css/gitalk.css'>
<script src='https://blog.nagih.io.vn/js/gitalk.min.js'></script>
<script>
  const gitalk = new Gitalk({
    clientID: 'Ov23li9UG1K7XEEbH2rX',
    clientSecret: '314c5b3c2437a868e716ca4bd2ee12ca9eb200e3',
    repo: 'blog',
    owner: 'vuongmanhnghia',
    admin: ['vuongmanhnghia'],
    id: eval("location.pathname"), 
    distractionFreeMode: false 
  });
  (function() {
    gitalk.render('gitalk-container');
  })();
</script>

</div>

  <div class="footer container-xl width-full p-responsive">
	<div
		class="position-relative d-flex flex-row-reverse flex-lg-row flex-wrap flex-lg-nowrap flex-justify-center flex-lg-justify-between flex-sm-items-center pt-6 pb-2 mt-6 f6 text-gray border-top border-gray-light">
		<a
			target="_blank"
			aria-label="Homepage"
			title="GitHub"
			class="footer-octicon d-none d-lg-block mr-lg-4"
			href="https://blog.nagih.io.vn/">
			<svg
				height="24"
				class="octicon octicon-mark-github"
				viewBox="0 0 16 16"
				version="1.1"
				width="24">
				<path
					fill-rule="evenodd"
					d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path>
			</svg>
		</a>
		<ul
			class="list-style-none d-flex flex-wrap col-12 flex-justify-center flex-lg-justify-between mb-2 mb-lg-0">
			
			<li class="mr-3 mr-lg-0">
				<a href="https://github.com/vuongmanhnghia" target="_blank"
					>Vuong Manh Nghia</a
				>
			</li>
			
			<li class="mr-3 mr-lg-0">
				GitHub and the Invertocat logo are trademarks of
				<a href="https://github.com/" target="_blank">GitHub, Inc.</a>
			</li>
		</ul>
	</div>
	<div class="d-flex flex-justify-center pb-6">
		<span class="f6 text-gray-light"></span>
	</div>
</div>

</body>

<script type="application/javascript" src="https://blog.nagih.io.vn/js/github-style.js"></script>





<script src="https://cdn.jsdelivr.net/npm/fuse.js/dist/fuse.min.js"></script>
<script type="application/javascript" src='https://blog.nagih.io.vn/js/search.js'></script>



</html>