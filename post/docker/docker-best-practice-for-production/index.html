<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <script type="application/javascript" src='https://blog.nagih.io.vn/js/theme-mode.js'></script>
    <link rel="stylesheet" href='https://blog.nagih.io.vn/css/frameworks.min.css' />
    <link rel="stylesheet" href='https://blog.nagih.io.vn/css/github.min.css' />
    <link rel="stylesheet" href='https://blog.nagih.io.vn/css/github-style.css' />
    <link rel="stylesheet" href='https://blog.nagih.io.vn/css/light.css' />
    <link rel="stylesheet" href='https://blog.nagih.io.vn/css/dark.css' />
    <link rel="stylesheet" href='https://blog.nagih.io.vn/css/syntax.css' />
    <title>Docker Best Practice for Production - Nagih&#39;s blog</title>
    
    <link rel="icon" type="image/x-icon" href='/images/avatar.png'>
    
    <meta name="theme-color" content="#1e2327">

    <link rel="stylesheet" href="https://blog.nagih.io.vn/css/custom.css">
    <script type="text/javascript" src="https://blog.nagih.io.vn/js/custom.js"></script>

    
    <meta name="description"
  content="Các Thực tiễn Tốt nhất cho Môi trường Production
" />
<meta name="keywords"
  content='blog, google analytics' />
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://blog.nagih.io.vn/post/docker/docker-best-practice-for-production/" />


<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Docker Best Practice for Production - Nagih&#39;s blog" />
<meta name="twitter:description"
  content="Các Thực tiễn Tốt nhất cho Môi trường Production
" />
<meta name="twitter:site" content="https://blog.nagih.io.vn/" />
<meta name="twitter:creator" content="" />
<meta name="twitter:image"
  content="https://blog.nagih.io.vn/">


<meta property="og:type" content="article" />
<meta property="og:title" content="Docker Best Practice for Production - Nagih&#39;s blog">
<meta property="og:description"
  content="Các Thực tiễn Tốt nhất cho Môi trường Production
" />
<meta property="og:url" content="https://blog.nagih.io.vn/post/docker/docker-best-practice-for-production/" />
<meta property="og:site_name" content="Docker Best Practice for Production" />
<meta property="og:image"
  content="https://blog.nagih.io.vn/">
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">

<meta property="article:published_time" content="2025-08-15 00:00:00 &#43;0000 UTC" />













</head>


<body>
  <div style="position: relative">
	<header
		class="Header js-details-container Details px-3 px-md-4 px-lg-5 flex-wrap flex-md-nowrap open Details--on">
		<div
			class="Header-item mobile-none"
			style="margin-top: -4px; margin-bottom: -4px">
			<a class="Header-link" href="https://blog.nagih.io.vn/">
				<img
					class="octicon"
					height="32"
					width="32"
					src="https://avatars.githubusercontent.com/u/123850496?v=4" />
			</a>
		</div>
		<div class="Header-item d-md-none">
			<button
				class="Header-link btn-link js-details-target"
				type="button"
				onclick="document.querySelector('#header-search').style.display = document.querySelector('#header-search').style.display == 'none'? 'block': 'none'">
				<svg
					height="24"
					class="octicon octicon-three-bars"
					viewBox="0 0 16 16"
					version="1.1"
					width="24">
					<path
						fill-rule="evenodd"
						d="M1 2.75A.75.75 0 011.75 2h12.5a.75.75 0 110 1.5H1.75A.75.75 0 011 2.75zm0 5A.75.75 0 011.75 7h12.5a.75.75 0 110 1.5H1.75A.75.75 0 011 7.75zM1.75 12a.75.75 0 100 1.5h12.5a.75.75 0 100-1.5H1.75z"></path>
				</svg>
			</button>
		</div>
		<div
			style="display: none"
			id="header-search"
			class="Header-item Header-item--full flex-column flex-md-row width-full flex-order-2 flex-md-order-none mr-0 mr-md-3 mt-3 mt-md-0 Details-content--hidden-not-important d-md-flex">
			<div
				class="Header-search header-search flex-auto js-site-search position-relative flex-self-stretch flex-md-self-auto mb-3 mb-md-0 mr-0 mr-md-3 scoped-search site-scoped-search js-jump-to">
				<div class="position-relative">
					
					<form
						id="search-form"
						action=""
						accept-charset="UTF-8"
						method="get"
						autocomplete="off">
						<label
							class="Header-search-label form-control input-sm header-search-wrapper p-0 js-chromeless-input-container header-search-wrapper-jump-to position-relative d-flex flex-justify-between flex-items-center">
							<input
								type="text"
								class="Header-search-input form-control input-sm header-search-input jump-to-field js-jump-to-field js-site-search-focus js-site-search-field is-clearable"
								name="q"
								value=""
								placeholder="Search"
								autocomplete="off" />
						</label>
					</form>
					
				</div>
			</div>
		</div>

		<div
			class="Header-item Header-item--full flex-justify-center d-md-none position-relative">
			<a class="Header-link" href="https://blog.nagih.io.vn/">
				<img
					class="octicon octicon-mark-github v-align-middle"
					height="32"
					width="32"
					src="https://avatars.githubusercontent.com/u/123850496?v=4" />
			</a>
		</div>
		<div class="Header-item" style="margin-right: 0">
			<a
				href="javascript:void(0)"
				class="Header-link no-select"
				onclick="switchTheme()">
				<svg
					style="fill: var(--color-profile-color-modes-toggle-moon)"
					class="no-select"
					viewBox="0 0 16 16"
					version="1.1"
					width="16"
					height="16">
					<path
						fill-rule="evenodd"
						clip-rule="evenodd"
						d="M4.52208 7.71754C7.5782 7.71754 10.0557 5.24006 10.0557 2.18394C10.0557 1.93498 10.0392 1.68986 10.0074 1.44961C9.95801 1.07727 10.3495 0.771159 10.6474 0.99992C12.1153 2.12716 13.0615 3.89999 13.0615 5.89383C13.0615 9.29958 10.3006 12.0605 6.89485 12.0605C3.95334 12.0605 1.49286 10.001 0.876728 7.24527C0.794841 6.87902 1.23668 6.65289 1.55321 6.85451C2.41106 7.40095 3.4296 7.71754 4.52208 7.71754Z"></path>
				</svg>
			</a>
		</div>
	</header>
</div>

  <div id="search-result" class="container-lg px-3 new-discussion-timeline" style="display: none;">
</div>

  
<div class="application-main">
  <div>
  <main>
    <div class="gisthead pagehead bg-gray-light pb-0 pt-3 mb-4">
      <div class="px-0">
        <div class="mb-3 d-flex px-3 px-md-3 px-lg-5">
          <div class="flex-auto min-width-0 width-fit mr-3">
            <div class="d-flex">
              <div class="d-none d-md-block">
                <a class="avatar mr-2 flex-shrink-0" href="https://blog.nagih.io.vn/">
                  <img class=" avatar-user"
                    src="https://avatars.githubusercontent.com/u/123850496?v=4"
                    width="32" height="32"></a>
              </div>
              <div class="d-flex flex-column">
                <h1 class="break-word f3 text-normal mb-md-0 mb-1">
                  <span class="author">
                    <strong>
                      <a href="https://blog.nagih.io.vn/">Nagih</a>
                    </strong>
                  </span>
                  <span class="path-divider">/</span>
                  <strong class="css-truncate css-truncate-target mr-1" style="max-width: 410px">
                    <a href="https://blog.nagih.io.vn/post/docker/docker-best-practice-for-production/">Docker Best Practice for Production</a>
                  </strong>
                </h1>
                <div class="note m-0">
                  Created <relative-time datetime="Fri, 15 Aug 2025 00:00:00 &#43;0000"
                    class="no-wrap">
                    Fri, 15 Aug 2025 00:00:00 &#43;0000</relative-time>

                  
                  <span class="file-info-divider"></span>
                  Modified <relative-time datetime="Fri, 29 Aug 2025 14:26:57 &#43;0700"
                    class="no-wrap">
                    Fri, 29 Aug 2025 14:26:57 &#43;0700</relative-time>
                  
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container-lg px-3 new-discussion-timeline">
      <div class="repository-content gist-content">
        <div>
          <div class="js-gist-file-update-container js-task-list-container file-box">
            <div id="file-pytest" class="file my-2">
              <div id="post-header" class="file-header d-flex flex-md-items-center flex-items-start sticky-header" style="z-index: 2">
                <div class="file-info d-flex flex-md-items-center flex-items-start flex-order-1 flex-auto">
                  <div class="text-mono f6 flex-auto pr-3 flex-order-2 flex-md-order-1 mt-2 mt-md-0">
                    
                    <summary id="toc-toggle" onclick="clickToc()" class="btn btn-octicon m-0 mr-2 p-2">
                      <svg aria-hidden="true" viewBox="0 0 16 16" height="16" width="16" class="octicon octicon-list-unordered">
                        <path fill-rule="evenodd" d="M2 4a1 1 0 100-2 1 1 0 000 2zm3.75-1.5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zm0 5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zm0 5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zM3 8a1 1 0 11-2 0 1 1 0 012 0zm-1 6a1 1 0 100-2 1 1 0 000 2z"></path>
                      </svg>
                    </summary>
                    <details-menu class="SelectMenu" id="toc-details" style="display: none;">
                      <div class="SelectMenu-modal rounded-3 mt-1" style="max-height: 340px;">
                        <div class="SelectMenu-list SelectMenu-list--borderless p-2" style="overscroll-behavior: contain;" id="toc-list">
                        </div>
                      </div>
                    </details-menu>
                      985 Words
                    

                  </div>
                  <div class="file-actions flex-order-2 pt-0">
                    
                    
                    <a class="muted-link mr-3" href="/tags/docker">
                      <svg class="octicon octicon-tag" viewBox="0 0 16 16" version="1.1" width="16" height="16">
                        <path fill-rule="evenodd"
                          d="M2.5 7.775V2.75a.25.25 0 01.25-.25h5.025a.25.25 0 01.177.073l6.25 6.25a.25.25 0 010 .354l-5.025 5.025a.25.25 0 01-.354 0l-6.25-6.25a.25.25 0 01-.073-.177zm-1.5 0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 010 2.474l-5.026 5.026a1.75 1.75 0 01-2.474 0l-6.25-6.25A1.75 1.75 0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z">
                        </path>
                      </svg>
                      docker
                    </a>
                    
                    
                  </div>
                </div>
              </div>


              <div class="Box-body px-5 pb-5" style="z-index: 1">
                <article class="markdown-body entry-content container-lg"><p>Các Thực tiễn Tốt nhất cho Môi trường Production</p>
<p>Phần 1: <a href="https://blog.nagih.io.vn/post/docker/docker/">Docker Principle</a></p>
<p>Phần 2: <a href="https://blog.nagih.io.vn/post/docker/docker-cli/">Docker CLI</a></p>
<p>Phần 3: <a href="https://blog.nagih.io.vn/post/docker/docker-dockerfile/">Docker Dockerfile</a></p>
<p>Phần 4: <a href="https://blog.nagih.io.vn/post/docker/docker-compose/">Docker Compose</a></p>
<p>Phần 5: <a href="https://blog.nagih.io.vn/post/docker/docker-practical-guide/">Docker Practical Guide</a></p>
<p>Phần 6: <a href="https://blog.nagih.io.vn/post/docker/docker-fullstack-example/">Docker Fullstack Example</a></p>
<h2 id="phần-6-các-thực-tiễn-tốt-nhất-cho-môi-trường-production">Phần 6: Các Thực tiễn Tốt nhất cho Môi trường Production</h2>
<p>Việc đưa các ứng dụng container hóa vào môi trường production đòi hỏi một mức độ cẩn trọng và tối ưu hóa cao hơn so với môi trường phát triển. Phần này sẽ cung cấp các thực tiễn tốt nhất, giúp bạn xây dựng các image nhỏ gọn, an toàn và các tệp Compose có khả năng bảo trì cao, sẵn sàng cho việc triển khai thực tế.</p>
<h3 id="61-tối-ưu-hóa-kích-thước-và-tốc-độ-multi-stage-builds">6.1 Tối ưu hóa Kích thước và Tốc độ: Multi-Stage Builds</h3>
<p>Một trong những vấn đề phổ biến nhất với các Docker image là chúng trở nên cồng kềnh. Một image lớn không chỉ chiếm nhiều dung lượng lưu trữ mà còn làm tăng thời gian tải về và triển khai. Tệ hơn nữa, nó thường chứa các công cụ xây dựng (như JDK, Go toolchain, <code>build-essentials</code>) và các dependencies chỉ cần thiết cho quá trình biên dịch, không cần thiết cho việc chạy ứng dụng. Những thành phần thừa này làm tăng bề mặt tấn công của image một cách không cần thiết.</p>
<p><strong>Multi-stage builds</strong> là một tính năng mạnh mẽ của Docker để giải quyết vấn đề này. Kỹ thuật này cho phép bạn sử dụng nhiều lệnh</p>
<p><code>FROM</code> trong cùng một <code>Dockerfile</code>. Mỗi lệnh <code>FROM</code> bắt đầu một &ldquo;stage&rdquo; (giai đoạn) xây dựng mới.</p>
<p>Cách hoạt động rất đơn giản và hiệu quả:</p>
<ol>
<li>
<p><strong>Stage 1 (Build Stage):</strong> Bạn sử dụng một image cơ sở đầy đủ (ví dụ: <code>golang:1.21</code>) có tất cả các công cụ cần thiết để biên dịch, kiểm thử và đóng gói ứng dụng của bạn. Giai đoạn này được đặt tên (ví dụ: <code>AS builder</code>).</p>
</li>
<li>
<p><strong>Stage 2 (Final Stage):</strong> Bạn bắt đầu một giai đoạn mới với một image cơ sở tối giản (ví dụ: <code>alpine:latest</code> hoặc thậm chí <code>scratch</code>—một image trống).</p>
</li>
<li>
<p><strong>Copy Artifacts:</strong> Bạn sử dụng lệnh <code>COPY --from=builder</code> để sao chép chỉ những tạo tác (artifacts) cần thiết—chẳng hạn như tệp nhị phân đã biên dịch hoặc các tệp đã được thu nhỏ—từ giai đoạn xây dựng vào giai đoạn cuối cùng.</p>
</li>
</ol>
<p>Ví dụ với ứng dụng Go từ Phần 4 đã minh họa hoàn hảo điều này. Image cuối cùng chỉ chứa tệp nhị phân thực thi và image Alpine cơ sở, giảm kích thước từ hàng trăm MB xuống chỉ còn vài MB.</p>
<h3 id="62-tăng-cường-bảo-mật">6.2 Tăng cường Bảo mật</h3>
<p>Bảo mật là yếu tố không thể bỏ qua khi triển khai. <code>Dockerfile</code> của bạn là tuyến phòng thủ đầu tiên.</p>
<ul>
<li>
<p><strong>Chạy với người dùng không phải root:</strong> Mặc định, các container chạy với người dùng <code>root</code>, điều này tạo ra một rủi ro bảo mật nghiêm trọng. Nếu một kẻ tấn công khai thác được một lỗ hổng trong ứng dụng của bạn và thoát ra khỏi container, chúng có thể có quyền <code>root</code> trên máy chủ. Hãy luôn tạo một người dùng và nhóm không có đặc quyền bên trong <code>Dockerfile</code> và sử dụng lệnh <code>USER</code> để chuyển sang người dùng đó trước khi chạy ứng dụng.</p>
<p>Dockerfile</p>
<pre tabindex="0"><code># Create a non-root user
RUN addgroup -S appgroup &amp;&amp; adduser -S appuser -G appgroup

#... copy files and set permissions...
RUN chown -R appuser:appgroup /app

# Switch to the non-root user
USER appuser

CMD [&#34;/app/my-binary&#34;]
</code></pre></li>
<li>
<p><strong>Chọn base image tối giản:</strong> Nguyên tắc là &ldquo;càng ít càng tốt&rdquo;. Một image cơ sở tối giản như <code>alpine</code>, <code>distroless</code>, hoặc <code>scratch</code> chứa ít thành phần hơn, đồng nghĩa với việc có ít lỗ hổng tiềm tàng hơn và bề mặt tấn công nhỏ hơn.</p>
</li>
<li>
<p><strong>Sử dụng <code>.dockerignore</code>:</strong> Tương tự như <code>.gitignore</code>, tệp <code>.dockerignore</code> ngăn chặn các tệp và thư mục không cần thiết (như <code>.git</code>, <code>node_modules</code>, các tệp log cục bộ, tệp bí mật) được gửi đến Docker daemon trong quá trình xây dựng. Điều này không chỉ giúp image nhỏ hơn mà còn ngăn chặn việc vô tình rò rỉ thông tin nhạy cảm vào image.</p>
</li>
</ul>
<h3 id="63-quản-lý-các-file-compose-có-thể-bảo-trì">6.3 Quản lý các file Compose có thể bảo trì</h3>
<p>Khi dự án phát triển, việc quản lý cấu hình cho các môi trường khác nhau (phát triển, kiểm thử, sản xuất) trở nên quan trọng.</p>
<ul>
<li>
<p><strong>Sử dụng biến môi trường và tệp <code>.env</code>:</strong> <strong>Không bao giờ</strong> ghi cứng các giá trị nhạy cảm như mật khẩu, khóa API, hoặc thông tin đăng nhập cơ sở dữ liệu trực tiếp vào tệp <code>docker-compose.yml</code>. Thay vào đó, hãy tham chiếu chúng dưới dạng biến môi trường. Docker Compose sẽ tự động tải các biến từ một tệp <code>.env</code> trong cùng thư mục. Tệp <code>.env</code> này nên được thêm vào <code>.gitignore</code> để đảm bảo nó không được đưa vào hệ thống quản lý phiên bản.</p>
<ul>
<li>
<p>Trong <code>docker-compose.yml</code>:</p>
<p>YAML</p>
<pre tabindex="0"><code>environment:
  - DB_PASSWORD=${POSTGRES_PASSWORD}
</code></pre></li>
<li>
<p>Trong tệp <code>.env</code>:</p>
<p>Code snippet</p>
<pre tabindex="0"><code>POSTGRES_PASSWORD=supersecret
</code></pre></li>
</ul>
</li>
<li>
<p><strong>Quản lý các môi trường khác nhau (Dev vs. Prod):</strong> Thay vì duy trì nhiều tệp Compose gần như giống hệt nhau, hãy sử dụng một tệp <code>docker-compose.yml</code> cơ sở cho các cấu hình chung và một tệp <code>docker-compose.override.yml</code> cho các cấu hình dành riêng cho môi trường phát triển. Docker Compose tự động đọc và hợp nhất cả hai tệp này.</p>
<ul>
<li>
<p><strong><code>docker-compose.yml</code> (cơ sở, cho production):</strong></p>
<p>YAML</p>
<pre tabindex="0"><code>services:
  web:
    image: my-app:latest
    ports: [&#34;80:8000&#34;]
</code></pre></li>
<li>
<p><strong><code>docker-compose.override.yml</code> (cho development, không commit vào Git):</strong></p>
<p>YAML</p>
<pre tabindex="0"><code>services:
  web:
    build:.
    volumes:
      -.:/app  # Mount source code for live reload
    ports:
      - &#34;8000:8000&#34;
    command: npm run dev
</code></pre></li>
</ul>
<p>Khi bạn chạy <code>docker compose up</code>, Compose sẽ hợp nhất hai tệp này, tạo ra một cấu hình phát triển hoàn chỉnh. Trong môi trường production, bạn chỉ cần triển khai tệp <code>docker-compose.yml</code> cơ sở.</p>
</li>
</ul>
<hr>
<p><em>Nếu thấy hay, hãy để lại cho mình 1 comment xuống phía dưới để mình có động lực viết các blog chất lượng tiếp theo nhé!</em></p></article>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>
<script type="application/javascript" src='https://blog.nagih.io.vn/js/toc.js'></script>
<link rel="stylesheet" href='https://blog.nagih.io.vn/css/toc.css' />

  
<div id="gitalk-container" class="gitalk-container"></div>
<link rel="stylesheet" href='https://blog.nagih.io.vn/css/gitalk.css'>
<script src='https://blog.nagih.io.vn/js/gitalk.min.js'></script>
<script>
  const gitalk = new Gitalk({
    clientID: 'Ov23li9UG1K7XEEbH2rX',
    clientSecret: '314c5b3c2437a868e716ca4bd2ee12ca9eb200e3',
    repo: 'blog',
    owner: 'vuongmanhnghia',
    admin: ['vuongmanhnghia'],
    id: eval("location.pathname"), 
    distractionFreeMode: false 
  });
  (function() {
    gitalk.render('gitalk-container');
  })();
</script>

</div>

  <div class="footer container-xl width-full p-responsive">
	<div
		class="position-relative d-flex flex-row-reverse flex-lg-row flex-wrap flex-lg-nowrap flex-justify-center flex-lg-justify-between flex-sm-items-center pt-6 pb-2 mt-6 f6 text-gray border-top border-gray-light">
		<a
			target="_blank"
			aria-label="Homepage"
			title="GitHub"
			class="footer-octicon d-none d-lg-block mr-lg-4"
			href="https://blog.nagih.io.vn/">
			<svg
				height="24"
				class="octicon octicon-mark-github"
				viewBox="0 0 16 16"
				version="1.1"
				width="24">
				<path
					fill-rule="evenodd"
					d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path>
			</svg>
		</a>
		<ul
			class="list-style-none d-flex flex-wrap col-12 flex-justify-center flex-lg-justify-between mb-2 mb-lg-0">
			
			<li class="mr-3 mr-lg-0">
				<a href="https://github.com/vuongmanhnghia" target="_blank"
					>Vuong Manh Nghia</a
				>
			</li>
			
			<li class="mr-3 mr-lg-0">
				GitHub and the Invertocat logo are trademarks of
				<a href="https://github.com/" target="_blank">GitHub, Inc.</a>
			</li>
		</ul>
	</div>
	<div class="d-flex flex-justify-center pb-6">
		<span class="f6 text-gray-light"></span>
	</div>
</div>

</body>

<script type="application/javascript" src="https://blog.nagih.io.vn/js/github-style.js"></script>





<script src="https://cdn.jsdelivr.net/npm/fuse.js/dist/fuse.min.js"></script>
<script type="application/javascript" src='https://blog.nagih.io.vn/js/search.js'></script>



</html>